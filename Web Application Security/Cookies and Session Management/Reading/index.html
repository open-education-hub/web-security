<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Web Application Security/Cookies and Session Management/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Cookies and Session Management | Web Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//web-security/Web Application Security/Cookies and Session Management/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cookies and Session Management | Web Security"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="canonical" href="http://localhost//web-security/Web Application Security/Cookies and Session Management/Reading/"><link data-rh="true" rel="alternate" href="http://localhost//web-security/Web Application Security/Cookies and Session Management/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//web-security/Web Application Security/Cookies and Session Management/Reading/" hreflang="x-default"><link rel="stylesheet" href="/web-security/assets/css/styles.48876178.css">
<link rel="preload" href="/web-security/assets/js/runtime~main.ee79574c.js" as="script">
<link rel="preload" href="/web-security/assets/js/main.13eefe83.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web-security/"><div class="navbar__logo"><img src="/web-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/web-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Web Security</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web-security/Web Application Security">Web Application Security</a><a class="navbar__item navbar__link" href="/web-security/Network and communication security">Network and communication security</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/web-security/Web Application Security/">Web Application Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web Application Security&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/web-security/Web Application Security/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/web-security/Web Application Security/Web basics/">Web basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/web-security/Web Application Security/Cookies and Session Management/">Cookies and Session Management</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cookies and Session Management&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/web-security/Web Application Security/Cookies and Session Management/Reading/">Reading</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reading&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web-security/Web Application Security/Cookies and Session Management/Reading/">Introduction</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web-security/Web Application Security/Cookies and Session Management/cookies-and-session-management">Slides</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/web-security/Web Application Security/SQL Injection/">SQL Injection</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQL Injection&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/web-security/Web Application Security/Cross-Site Scripting/">Cross-Site Scripting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cross-Site Scripting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/web-security/Network and communication security/">Network and communication security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Network and communication security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/web-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web-security/Web Application Security/"><span itemprop="name">Web Application Security</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web-security/Web Application Security/Cookies and Session Management/"><span itemprop="name">Cookies and Session Management</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Cookies and Session Management</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>In order to understand how to protect a web application, you need to understand how an attacker thinks.
And in order to do that, you need to understand how a platform is built and what techniques are used to ensure minimum usability.
As a first step, you can analyze web applications using readily available tools, such as the browser’s built-in Developer Tools.
Further on, you can attempt to find more information about the basic mechanisms that enable the server to identify its clients and keep tabs on who they are (authentication) and what they are allowed to do (authorization), through the use of cookies and sessions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stateful-http-cookies">Stateful HTTP: Cookies<a class="hash-link" href="#stateful-http-cookies" title="Direct link to heading">​</a></h2><p>As we mentioned in the previous session, HTTP is a stateless protocol used to communicate over the internet.
This means that a request is not aware of any of the previous ones, and each request is executed independently.
Given its stateless nature, simple mechanisms such as HTTP cookies were created to overcome the issue.</p><p>An HTTP cookie (also called web cookie, Internet cookie, browser cookie, or simply cookie) is a small piece of data sent from a website and stored on the user&#x27;s computer by the user&#x27;s web browser while the user is browsing.
Cookies were designed to be a reliable mechanism for websites to remember stateful information (such as items added in the shopping cart in an online store) or to record the user&#x27;s browsing activity (including clicking particular buttons, logging in, or recording which pages were visited in the past).
They can also be used to remember pieces of information that the user previously entered into form fields, such as names, addresses, passwords, and credit card numbers.</p><p><img loading="lazy" alt="Cookies" src="/web-security/assets/images/cookies-801ed1690e49b28263d3e2a616d3a8cc.png" width="768" height="428" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-a-cookie">What is a cookie?<a class="hash-link" href="#what-is-a-cookie" title="Direct link to heading">​</a></h3><p>A cookie is a <em>key=value</em> pair stored in a text file on the user’s computer.
This file can be found, for example, at the following path on a Windows 10 using Chrome:</p><p><code>C:\Users\Your User Name\AppData\Local\Google\Chrome\User Data\Default\Cookies</code></p><p>An example of cookies set for a website could be:</p><ul><li>username=admin</li><li>cookie_consent=1</li><li>theme=dark</li></ul><p>The first cookie stores the username, so it can be displayed to the user without querying the database.
The second one stores the choice made by the user regarding the cookie consent, so the application would not continue to show the message every time.
Finally, the third one stores which theme was selected (in this case, a dark theme).</p><p>Once a cookie has been set, the browser will send the cookie information in all subsequent HTTP requests until the cookie is deleted.
Additionally, the cookie can have zero or more attributes, such as:</p><ul><li><em>Domain</em> and <em>Path</em> attributes define the scope of the cookies.
These attributes tell the browser what website they belong to.</li><li><em>Same origin policy</em> dictates that websites are only allowed to set cookies on their own domain.
In other words, the <code>www.example.com</code> website is not allowed to set cookies on <code>www.test.com</code> and vice versa.
A website is only able to control cookies that are within its own domain.</li><li>The <em>Expires</em> attribute defines when the cookie is deleted.
Alternatively, the Max-Age attribute can be used to state the number of seconds after the cookie is to be deleted.</li><li>The <em>Secure</em> attribute defines that cookies should only be sent using secure channels such as HTTPS.
Cookies with the Secure attribute should only be sent through a secure connection.
This protects the application&#x27;s cookies against theft attempts.</li><li>The <em>http-only</em> attribute defines that cookie should be exposed only using HTTP or HTTPS channels.
This means that the cookies with this attribute cannot be accessed via client-side scripting or other methods.
This is a defense mechanism against <a href="https://owasp.org/www-community/HttpOnly" target="_blank" rel="noopener noreferrer">some attacks</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stateful-http-sessions">Stateful HTTP: Sessions<a class="hash-link" href="#stateful-http-sessions" title="Direct link to heading">​</a></h2><p>As previously stated, HTTP is stateless.
Therefore, it needs a mechanism to remember information from previous requests and associate it with a user for authentication purposes.
The cookies are one way to achieve this.
However, they are considered highly insecure because the user can easily manipulate their content.
We cannot directly use them for authentication and other sensitive data.
The solution to this problem is the session, which stores the data on the server, rather than the client.
The session ID can be used as a means of communication.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-a-session-work">How does a session work?<a class="hash-link" href="#how-does-a-session-work" title="Direct link to heading">​</a></h3><p>When accessing a website that uses sessions, each user is assigned a session ID.
They are more secure than the previously mentioned method mainly because the data never leaves the server, so an attacker cannot alter it.
Instead, the ID is used to uniquely identify each user and associate the respective information with them.</p><p>Sessions are usually short-lived, which makes them ideal for storing temporary states between pages.
Sessions also expire once the user closes his browser or after a predefined amount of time (for example, 30 minutes).</p><p>The basic workflow is:</p><ol><li>The server starts a new session (sets a cookie via the HTTP Cookie header).</li><li>The server sets a new session variable (stored on the server-side).</li><li>When the client changes the page, it sends all the cookies in the request, along with the session ID from step 1.</li><li>The server reads the session ID from the cookie.</li><li>The server matches the session ID with the entries of a local list (in-memory, text file etc.).</li><li>If the server finds a match, it reads the stored variables. For PHP, these variables will become available in the superglobal variable <code>$_SESSION</code>.</li><li>If the server doesn’t find a match, it will create a new session and repeat steps 1-6.</li></ol><p><img loading="lazy" alt="Session lifecycle" src="/web-security/assets/images/session-4d2456ea8afc9c174b432bf9f1f4830a.jpg" width="602" height="473" class="img_ev3q"></p><p>Example of a session in PHP:</p><div class="language-php codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-php codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?php</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session_start(); // Start the session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$_SESSION[&#x27;username&#x27;] = &quot;John Doe&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$_SESSION[&#x27;is_admin&#x27;] = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;Hello &quot; . $_SESSION[&#x27;username&#x27;];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">?&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Example of a session in Python:</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">s </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Session</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://httpbin.org/cookies/set/sessioncookie/123456789&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">r </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> s</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://httpbin.org/cookies&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">r</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># &#x27;{&quot;cookies&quot;: {&quot;sessioncookie&quot;: &quot;123456789&quot;}}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One might consider that sessions are pretty secure.
However, they won’t stop an attacker to intercept the cookie with the session ID, for example using a <a href="https://www.imperva.com/learn/application-security/man-in-the-middle-attack-mitm/" target="_blank" rel="noopener noreferrer">Man-in-the-Middle attack</a> over an insecure Wi-Fi connection, and steal the session ID to use it.
This won’t give them access to the values that are stored on the server, but they will be able to impersonate the user or perform actions on their behalf.
This is known as session hijacking.
You can read more on this subject <a href="https://owasp.org/www-community/attacks/Session_hijacking_attack" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://www.netsparker.com/blog/web-security/session-hijacking/" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="authentication-vs-authorization">Authentication vs Authorization<a class="hash-link" href="#authentication-vs-authorization" title="Direct link to heading">​</a></h2><p>Two concepts that usually make people confused are authentication and authorization.
Both terms are often used in conjunction with each other when it comes to security and gaining access to the system.
They are essential in almost every modern web application, as most of these apps need a way to uniquely identify their users using an account.
These accounts can contain both personal information, available only to the logged in user, and public information, available to anybody.
Based on the privilege level, users can have access to various functionalities, such as deleting other users, creating blog posts etc.</p><p>Fundamentally, authentication refers to <strong>who you are</strong> while authorization refers to <strong>what you can do</strong>.</p><p><strong>Authentication</strong> is the process of verifying the identity of a person or device.
A common example is entering a username and password when you log in to a website.
Entering the correct login information lets the website know who you are and that it is actually you accessing the website.</p><p>There could be other methods of authentication, such as passcodes, biometrics (fingerprints), Two-Factor Authentication, etc.
We won’t insist too much on these other methods, but it’s good to know they exist.</p><p><strong>Authorization</strong> is a security mechanism to determine access levels or user/client privileges related to system resources including files, services, computer programs, data and application features.
This is the process of granting or denying access to a network resource that allows the user access to various resources based on the user&#x27;s identity.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="real-life-scenarios">Real-life scenarios<a class="hash-link" href="#real-life-scenarios" title="Direct link to heading">​</a></h3><p>Now imagine what would happen if someone obtains access to your Facebook account.
Besides the previously public information, such as your name and your birthday, they can now view your friend lists, private conversations, or even impersonate you through a post.
Although this situation won’t affect Facebook directly, it will certainly affect you.</p><p>What if someone were to gain access to an administrator account of a university?
They could remove all the students, erase their grades and all the study materials.
This would be a really nefarious incident that would destroy the institution’s reputation and will also affect you as a student.</p><p>This is why authentication and authorization are very important and their security is crucial.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="path-traversal">Path Traversal<a class="hash-link" href="#path-traversal" title="Direct link to heading">​</a></h2><p>In many web applications, resources are accessed using a filename as a parameter.
This file is processed and displayed to the client by the application.
If the application does not verify the parameter, the attacker might be able to exploit the application and display an arbitrary file from the target system.
Normally an attacker would try to access password or configuration files to gain access to the system.
Obviously, server-side script files could be accessed to perform manual inspection for vulnerabilities.
Consider the following URL:</p><p><code>http://example.com/view.php?file=image.jpg</code></p><p>If the attacker wants to investigate the view.php file for possible exploitable coding mistakes, he would try to use the script in order to open the file:</p><p><code>http://example.com/view.php?file=view.php </code></p><p>It is likely that images are stored in a subdirectory, so the attacker might have to access the parent directory:</p><p><code>http://example.com/view.php?file=../view.php</code> or <code>http://example.com/view.php?file=../../view.php</code></p><p>Depending on the system, a backslash could also be used:</p><p><code>http://example.com/view.php?file=..\..\view.php </code></p><p>An example of accessing system files:</p><p><code>http://example.com/view.php?file=../../../../etc/passwd</code></p><p><img loading="lazy" alt="Path Traversal" src="/web-security/assets/images/path_traversal-7528c28d3a345972cb3d79568a6ce618.png" width="803" height="467" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="path-traversal-prevention">Path Traversal Prevention<a class="hash-link" href="#path-traversal-prevention" title="Direct link to heading">​</a></h3><p>The application should not allow directory traversal or the accessing of arbitrary files.
If the files to be accessed are known, the application should implement a mapping between the file and application-specific identifier.
This identifier can be hardcoded in the application to prevent any malicious attempts to modify it.</p><p>If it is considered unavoidable to pass user-supplied input to filesystem APIs, then two layers of defense should be used together to prevent attacks:</p><ul><li>The application should validate the user input before processing it.
Ideally, the validation should compare against a whitelist of permitted values.
If that isn&#x27;t possible for the required functionality, then the validation should verify that the input contains only permitted content, such as purely alphanumeric characters.</li><li>After validating the supplied input, the application should append the input to the base directory and use a platform filesystem API to canonicalize the path.
It should verify that the canonicalized path starts with the expected base directory.</li></ul><p>Below is an example of some simple Java code to validate the canonical path of a file based on user input:</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">File file = new File(BASE_DIRECTORY, userInput);`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (file.getCanonicalPath().startsWith(BASE_DIRECTORY)) {`</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// process file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="insecure-direct-object-references">Insecure Direct Object References<a class="hash-link" href="#insecure-direct-object-references" title="Direct link to heading">​</a></h2><p>Insecure direct object reference vulnerability is similar to path traversal vulnerability.
The application allows access to resources using an identifier that is controllable by the user.
In this case, however, the identifier is not a file / path as is the case with path traversal.</p><p>Consider the following case where a user is able to view his own invoice:</p><p><code>http://www.example.com/view.php?invoice=24411</code></p><p>Now, by changing the invoice number the user might be able to access other invoices, including ones that are not his own, thereby gaining access to the sensitive information of other users.
Obviously the application should enforce access control over the items to be accessed.
If the application fails to do so, this would be a case of insecure direct object reference vulnerability.</p><p>When performing penetration tests, the application parameters should certainly be investigated by iterating through possible values and observing the responses.</p><p><img loading="lazy" alt="Insecure Direct Object References" src="/web-security/assets/images/insecure_direct_object_references-9e12426b8ec815e68c7940941170f960.png" width="800" height="498" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="insecure-direct-object-references-prevention">Insecure Direct Object References Prevention<a class="hash-link" href="#insecure-direct-object-references-prevention" title="Direct link to heading">​</a></h3><p>First, you should control all normal, ajax and API requests when creating an application.
For example, can a read-only user write anything in the app?
Or can a non-admin user access and create API tokens that should only be created by an admin user?
So, in order to test all the possible IDOR vulnerabilities, you should think like a hacker.</p><p>You can provide permissions on your application for all endpoints.
If your <code>privatesection</code> endpoint includes the API requests such as <code>/api/privatesection/admins</code>, <code>/api/privatesection/console</code>, <code>/api/privatesection/tokens</code>, you can block the endpoint for non-admin users.</p><p>Moreover, to make the attacker’s job harder or prevent it altogether, you can use hash functions and hashed values instead of regular numbers and strings.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="robotstxt-preventing-caching">robots.txt: Preventing Caching<a class="hash-link" href="#robotstxt-preventing-caching" title="Direct link to heading">​</a></h3><p>The <strong>robots.txt</strong> file provides a list of instructions for automated Web crawlers, also called robots or bots.
Standardized at <a href="http://www.robotstxt.org/robotstxt.html" target="_blank" rel="noopener noreferrer">robotstxt</a>, this file allows you to define, with a great deal of precision, which files and directories are off-limits to Web robots.
The robots.txt file must be placed in the root of the Web server with permissions that allow the Web server to read the file.
Lines in the file beginning with a # sign are considered comments and are ignored.
Each line not beginning with a <code>#</code> should begin with either a User-agent or a disallow statement, followed by a colon and an optional space.
These lines are written to disallow certain crawlers from accessing certain directories or files.</p><p>Each Web crawler should send a user-agent field, which lists the name or type of the crawler.
The value of Google’s user-agent field is <code>Googlebot</code>.
To address a disallow to Google, the user-agent line should read:</p><p><code>User-agent: Googlebot</code></p><p>According to the original specification, the wildcard character <code>*</code> can be used in the user-agent field to indicate all crawlers.
The disallow line describes what, exactly; the crawler should not look at.</p><p><strong>NOTE:</strong> Hackers don’t have to obey your robots.txt file.
In fact, Web crawlers really don’t have to either, although most of the big-name Web crawlers will, if only for the “CYA” factor.
One fairly common hacker trick is to view a site’s robots.txt file first to get an idea of how files and directories are mapped on the server.
In fact a quick Google query can reveal lots of sites that have had their robots.txt files crawled.
This, of course, is a misconfiguration, because the robots.txt file is meant to stay behind the scenes.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="sitemapxml">Sitemap.xml<a class="hash-link" href="#sitemapxml" title="Direct link to heading">​</a></h3><p>The sitemap.xml is a simple XML page which could be available on some websites and provide a “roadmap” for Google to the important pages that need to be crawled.
It’s a SEO (Search Engine Optimization) tool to help with the visibility of your website on the internet, but it could also be useful for a hacker, serving basically the same purpose: to give him a roadmap to every page.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="examples-of-google-dorking">Examples of Google Dorking<a class="hash-link" href="#examples-of-google-dorking" title="Direct link to heading">​</a></h3><ul><li><p>Google Hacking tool from <a href="https://pentest-tools.com/information-gathering/google-hacking" target="_blank" rel="noopener noreferrer">Pentest-Tools</a></p></li><li><p>Passive Google Dork <a href="https://github.com/opsdisk/pagodo" target="_blank" rel="noopener noreferrer">Pagodo</a></p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="explore-log-files-for-login-credentials">Explore LOG Files For Login Credentials<a class="hash-link" href="#explore-log-files-for-login-credentials" title="Direct link to heading">​</a></h3><p><code>allintext:password filetype:log after:2019</code> - Finds exposed log files that might contain passwords.</p><p><code>allintext:username filetype:log</code> - Finds logs that contain usernames.</p><p><strong>Prevention:</strong> Do not allow Google to access important data of your website, by properly configuring robots.txt.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="explore-configurations-using-env-files">Explore Configurations Using <strong>ENV</strong> files<a class="hash-link" href="#explore-configurations-using-env-files" title="Direct link to heading">​</a></h3><p>.env is used by various popular web development frameworks to declare general variables and configurations.</p><p><code>DB_USERNAME filetype:env</code><br>
<code>DB_PASSWORD filetype:enc=v</code></p><p>By using the command you can find a list of sites that expose their <em>.env</em> file on the internet.
Developers may accidentally include the <em>.env</em> file in the public directory of the website, which can cause great harm if cyber criminals find it.</p><p>If you click into any of the exposed .env files, you will notice unencrypted usernames, passwords and IPs are directly exposed in the search results.
<strong>Prevention:</strong> <em>.env</em> files should <strong>not</strong> be in a publicly accessible folder.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wayback-machine">Wayback Machine<a class="hash-link" href="#wayback-machine" title="Direct link to heading">​</a></h2><p>The <a href="https://archive.org/web/" target="_blank" rel="noopener noreferrer">Wayback Machine</a> is a digital archive of the entire internet.
It allows the user to go “back in time” and see what websites looked like in the past.
For a hacker, it can be useful to see what information was displayed on a website a few months ago or even a few years ago.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="wrap-up">Wrap-up<a class="hash-link" href="#wrap-up" title="Direct link to heading">​</a></h2><p>In this rapidly evolving world, the technologies we use change at a very fast pace.
We need to constantly implement new systems to help solve the issues that arise.
Since HTTP is stateless, dynamic web applications needed a way to preserve the state between requests, so they used cookies and sessions.</p><p>It’s very important to understand the difference between authentication and authorization.
Almost every web application on the internet today has one form or another of authentication and authorization.
Many <a href="https://techterms.com/definition/framework#:~:text=A%20framework%2C%20or%20software%20framework,programs%20for%20a%20specific%20platform" target="_blank" rel="noopener noreferrer">frameworks</a> and <a href="https://techterms.com/definition/cms" target="_blank" rel="noopener noreferrer">Content Management Systems</a> provide built-in implementations of authorization and authentication to make the job of web developers easier.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="browser-extensions">Browser Extensions<a class="hash-link" href="#browser-extensions" title="Direct link to heading">​</a></h2><p>Some browser extensions can make your life easier when interacting with the websites. Some examples would be:</p><ul><li><p><strong>EditThisCookie</strong>: Lets you quickly add, edit or delete a cookie.
It could be useful to open a context-menu with one click and edit a cookie on the fly while navigating, without the need to open the developer tools console.</p><ul><li>Google Chrome link: <a href="https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg" target="_blank" rel="noopener noreferrer">https://chrome.google.com/webstore/detail/editthiscookie/fngmhnnpilhplaeedifhccceomclgfbg</a></li><li>Mozilla Firefox link: <a href="https://addons.mozilla.org/en-US/firefox/addon/etc2/" target="_blank" rel="noopener noreferrer">https://addons.mozilla.org/en-US/firefox/addon/etc2/</a></li></ul></li><li><p><strong>ModHeader</strong>: Lets you add, modify and remove request headers and response headers. You can use this extension to set <strong>X-Forwarded-For</strong>, <strong>Authorization</strong>, <strong>Access-Control-Allow-Origin</strong> and other headers and remember your settings across your account.</p><ul><li>Google Chrome link: <a href="https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj" target="_blank" rel="noopener noreferrer">https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj</a></li><li>Mozilla Firefox link: <a href="https://addons.mozilla.org/en-US/firefox/addon/modheader-firefox/" target="_blank" rel="noopener noreferrer">https://addons.mozilla.org/en-US/firefox/addon/modheader-firefox/</a></li></ul></li><li><p><strong>Hasher</strong>: An extension to quickly generate most common <strong>hashes</strong> (<em>MD5</em>, <em>SHA-1</em>, <em>SHA-224</em>, <em>SHA-256</em>, <em>SHA-384</em>, <em>SHA-512</em>, etc), <strong>ciphers</strong> (<em>AES-256</em>, <em>DES</em>, <em>Triple-DES</em>, <em>RC4</em>, etc), <strong>ROT13</strong>, <strong>HMAC</strong>, <strong>CRC</strong> (<em>CRC-8</em>, <em>CRC 16</em>), for a given input. You can also convert timestamps to human readable formats, convert numbers from different bases (hex, binary, dec), encode or decode strings and convert between <em>ASCII</em>, <em>HEX</em>, <em>UTF-8</em>, etc.</p><ul><li>Google Chrome link: <a href="https://chrome.google.com/webstore/detail/hasher/kignjplbjlocolcfldfhbonmbblpfbjb" target="_blank" rel="noopener noreferrer">https://chrome.google.com/webstore/detail/hasher/kignjplbjlocolcfldfhbonmbblpfbjb</a></li></ul></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/web-security/Web Application Security/Cookies and Session Management/Reading/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Reading</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web-security/Web Application Security/Cookies and Session Management/cookies-and-session-management"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">cookies-and-session-management</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#stateful-http-cookies" class="table-of-contents__link toc-highlight">Stateful HTTP: Cookies</a><ul><li><a href="#what-is-a-cookie" class="table-of-contents__link toc-highlight">What is a cookie?</a></li></ul></li><li><a href="#stateful-http-sessions" class="table-of-contents__link toc-highlight">Stateful HTTP: Sessions</a><ul><li><a href="#how-does-a-session-work" class="table-of-contents__link toc-highlight">How does a session work?</a></li></ul></li><li><a href="#authentication-vs-authorization" class="table-of-contents__link toc-highlight">Authentication vs Authorization</a><ul><li><a href="#real-life-scenarios" class="table-of-contents__link toc-highlight">Real-life scenarios</a></li></ul></li><li><a href="#path-traversal" class="table-of-contents__link toc-highlight">Path Traversal</a><ul><li><a href="#path-traversal-prevention" class="table-of-contents__link toc-highlight">Path Traversal Prevention</a></li></ul></li><li><a href="#insecure-direct-object-references" class="table-of-contents__link toc-highlight">Insecure Direct Object References</a><ul><li><a href="#insecure-direct-object-references-prevention" class="table-of-contents__link toc-highlight">Insecure Direct Object References Prevention</a></li><li><a href="#robotstxt-preventing-caching" class="table-of-contents__link toc-highlight">robots.txt: Preventing Caching</a></li><li><a href="#sitemapxml" class="table-of-contents__link toc-highlight">Sitemap.xml</a></li><li><a href="#examples-of-google-dorking" class="table-of-contents__link toc-highlight">Examples of Google Dorking</a></li><li><a href="#explore-log-files-for-login-credentials" class="table-of-contents__link toc-highlight">Explore LOG Files For Login Credentials</a></li><li><a href="#explore-configurations-using-env-files" class="table-of-contents__link toc-highlight">Explore Configurations Using <strong>ENV</strong> files</a></li></ul></li><li><a href="#wayback-machine" class="table-of-contents__link toc-highlight">Wayback Machine</a></li><li><a href="#wrap-up" class="table-of-contents__link toc-highlight">Wrap-up</a></li><li><a href="#browser-extensions" class="table-of-contents__link toc-highlight">Browser Extensions</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security.cs.pub.ro/summer-school/wiki/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 SSS Team</div></div></div></footer></div>
<script src="/web-security/assets/js/runtime~main.ee79574c.js"></script>
<script src="/web-security/assets/js/main.13eefe83.js"></script>
</body>
</html>