<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Web Application Security/Cross-Site Scripting/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Cross-site Scripting (XSS) | Web Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//web-security/Web Application Security/Cross-Site Scripting/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cross-site Scripting (XSS) | Web Security"><meta data-rh="true" name="description" content="Intro"><meta data-rh="true" property="og:description" content="Intro"><link data-rh="true" rel="canonical" href="http://localhost//web-security/Web Application Security/Cross-Site Scripting/Reading/"><link data-rh="true" rel="alternate" href="http://localhost//web-security/Web Application Security/Cross-Site Scripting/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//web-security/Web Application Security/Cross-Site Scripting/Reading/" hreflang="x-default"><link rel="stylesheet" href="/web-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/web-security/assets/js/runtime~main.8db9aea3.js" as="script">
<link rel="preload" href="/web-security/assets/js/main.13eefe83.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web-security/"><div class="navbar__logo"><img src="/web-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/web-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Web Security</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web-security/Web Application Security">Web Application Security</a><a class="navbar__item navbar__link" href="/web-security/Network and communication security">Network and communication security</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/web-security/Web Application Security/">Web Application Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web Application Security&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/web-security/Web Application Security/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/web-security/Web Application Security/Web basics/">Web basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/web-security/Web Application Security/Cookies and Session Management/">Cookies and Session Management</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cookies and Session Management&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/web-security/Web Application Security/SQL Injection/">SQL Injection</a><button aria-label="Toggle the collapsible sidebar category &#x27;SQL Injection&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/web-security/Web Application Security/Cross-Site Scripting/">Cross-Site Scripting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Cross-Site Scripting&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/web-security/Web Application Security/Cross-Site Scripting/Reading/">Reading</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reading&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web-security/Web Application Security/Cross-Site Scripting/Reading/">Introduction</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web-security/Web Application Security/Cross-Site Scripting/cross-site-scripting">Slides</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/web-security/Network and communication security/">Network and communication security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Network and communication security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/web-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web-security/Web Application Security/"><span itemprop="name">Web Application Security</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web-security/Web Application Security/Cross-Site Scripting/"><span itemprop="name">Cross-Site Scripting</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Cross-site Scripting (XSS)</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="intro">Intro<a class="hash-link" href="#intro" title="Direct link to heading">​</a></h2><p>Cross-site Scripting (XSS) is a web security vulnerability that allows an attacker to inject malicious code, usually JavaScript, in the web browser of the victim. This implies that the attacker can do a lot of damage from stealing data to perform actions on behalf of the user. This type of vulnerability implies that the web application uses the user input in the HTML page that it serves. As opposed to other types of code injections, the malicious code in an XSS will always run on the client-side shifting the target from the server hosting the application to the users of the application.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="impact">Impact<a class="hash-link" href="#impact" title="Direct link to heading">​</a></h2><p>The impact of the vulnerability is linked with the functionality that the web application provides. If the app is doesn&#x27;t have much functionality (e.g. a news website) the attacker might not obtain much, but if it&#x27;s a banking app, there is certainly something to obtain.</p><p>Cross-site Scripting can be used to achieve a lot of things:</p><ul><li>steal data - sensitive data as login credentials or credit card numbers</li><li>hijack the session of the user - get the user&#x27;s session token and browse the application as it&#x27;s your account without any credentials</li><li>track user movements - keylogging, taking screenshots of the page</li><li>perform actions on behalf of the user - sending payments to attacker&#x27;s account</li><li>alter the looks of the HTML page (virtual defacement) - fake the balance of the account while the attacker steals the money</li><li>mining - placing a cryptocurrency miner in the page while the user reads a long article</li><li>if that&#x27;s not enough, you may find more ideas <a href="http://www.xss-payloads.com/payloads.html" target="_blank" rel="noopener noreferrer">here</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="types">Types<a class="hash-link" href="#types" title="Direct link to heading">​</a></h2><p>There are mainly three types of XSS:</p><ul><li>Reflected XSS</li><li>Stored XSS</li><li>DOM XSS</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reflected-xss">Reflected XSS<a class="hash-link" href="#reflected-xss" title="Direct link to heading">​</a></h3><p>Reflected XSS or non-persistent is the simplest form of XSS and occurs when user input is immediately returned by the web application in the HTTP response.</p><p><img loading="lazy" alt="Reflected XSS Steps" src="/web-security/assets/images/reflected-xss-612e4f212ce0d814dbbbd9a3f231be50.png" width="848" height="420" class="img_ev3q"></p><p><img loading="lazy" alt="Reflected XSS steps" src="/web-security/assets/images/XSS_reflected-19fe47ec709c1a579bcb8466503d961f.gif" width="571" height="251" class="img_ev3q"></p><ol><li>The attacker crafts a URL containing a malicious string and sends it to the victim.</li><li>The victim is tricked by the attacker into requesting the URL from the website.</li><li>The website includes the malicious string from the URL in the response.</li><li>The victim&#x27;s browser executes the malicious script inside the response, sending the victim&#x27;s cookies to the attacker&#x27;s server.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a class="hash-link" href="#example" title="Direct link to heading">​</a></h4><p>Let&#x27;s consider a simple application that greets the user with the name passed through the parameter <code>name</code> in the URL.
<code>https://example.com/greet?name=John</code></p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Hello John!</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Without changing the user input in any way, an attacker might give the following input:</p><p><code>https://example.com/greet?name=&lt;script&gt;alert(1)&lt;/script&gt;</code></p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Hello </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript number" style="color:#36acaa">1</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">!</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The attacker now has control to the JavaScript code using a parameter stored in the URL.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stored-xss">Stored XSS<a class="hash-link" href="#stored-xss" title="Direct link to heading">​</a></h3><p>Stored XSS or persistent XSS happens when user input is stored in the database and it is used non-sanitized in the response HTML pages.</p><p><img loading="lazy" alt="Persistent XSS Steps" src="/web-security/assets/images/persistent-xss-7d8b685d86e847911b9bfba3caff5434.png" width="804" height="456" class="img_ev3q"></p><p><img loading="lazy" alt="Stored XXS Steps" src="/web-security/assets/images/XSS_stored-f7b0fb13610b052ec9634af5ed878212.gif" width="561" height="411" class="img_ev3q"></p><ol><li>The attacker uses one of the website&#x27;s forms to insert a malicious string into the website&#x27;s database.</li><li>The victim requests a page from the website.</li><li>The website includes the malicious string from the database in the response and sends it to the victim.</li><li>The victim&#x27;s browser executes the malicious script inside the response, sending the victim&#x27;s cookies to the attacker&#x27;s server.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example<a class="hash-link" href="#example-1" title="Direct link to heading">​</a></h4><p>A simple example would be an online shop with a review system that would let customers to write text/comments about the products.
One might use it to say <code>&quot;This product is great! I recommend it!&quot;</code></p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">This product is great! I recommend it!</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But an attacker might use it to send <code>&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</code></p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript function" style="color:#d73a49">alert</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript number" style="color:#36acaa">1</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">p</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The difference between this example and the one at Reflected XSS is that the attacker uses a request to send the review that will be stored in the database of the server. Later on, when another user accesses the product page, the code behind the website will get from the database all reviews associated with the product and insert them in the HTML response page.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dom-xss">DOM XSS<a class="hash-link" href="#dom-xss" title="Direct link to heading">​</a></h3><p>DOM vulnerabilities usually arise when JavaScript code uses data from the user to construct the DOM / HTML page.</p><p><img loading="lazy" alt="DOM XSS Steps" src="/web-security/assets/images/dom-based-xss-26e3f1543764658d7f8453d9a4ab6b1a.png" width="902" height="576" class="img_ev3q">
<img loading="lazy" alt="XSS DOM Steps" src="/web-security/assets/images/XSS_dom-16a8185ed3a985685ab395ca8284a0fa.gif" width="551" height="371" class="img_ev3q"></p><ol><li>The attacker crafts a URL containing a malicious string and sends it to the victim.</li><li>The victim is tricked by the attacker into requesting the URL from the website.</li><li>The website receives the request, but does not include the malicious string in the response.</li><li>The victim&#x27;s browser executes the legitimate script inside the response, causing the malicious script to be inserted into the page.</li><li>The victim&#x27;s browser executes the malicious script inserted into the page, sending the victim&#x27;s cookies to the attacker&#x27;s server.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="example-2">Example<a class="hash-link" href="#example-2" title="Direct link to heading">​</a></h4><p>Suppose the following code is used to create a form to let the user choose his/her preferred language. A default language is also provided in the query string, as the parameter “default”.</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Select your language:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">select</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">write</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;&lt;OPTION value=1&gt;&quot;</span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">location</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">href</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">substring</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">location</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">href</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">indexOf</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;default=&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript number" style="color:#36acaa">8</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript operator" style="color:#393A34">+</span><span class="token script language-javascript string" style="color:#e3116c">&quot;&lt;/OPTION&gt;&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">write</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript string" style="color:#e3116c">&quot;&lt;OPTION value=2&gt;English&lt;/OPTION&gt;&quot;</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">select</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The page is invoked with a URL such as:</p><p><code>https://example.com/page.html?default=French</code></p><p>A DOM Based XSS attack against this page can be accomplished by sending the following URL to a victim:</p><p><code>https://example.com/page.html?default=&lt;script&gt;alert(1)&lt;/script&gt;</code></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="note">Note<a class="hash-link" href="#note" title="Direct link to heading">​</a></h2><p>The three types of XSS presented above are the ones that historically speaking were categorised, but in order to do a categorization a criteria is needed. The types above have no criteria on which they are sepparated, so let&#x27;s split XSS vulnerabilities by the place where data is used:</p><ul><li>Server XSS</li><li>Client XSS</li></ul><p>By doing so, the three types above mentioned will look like this:
<img loading="lazy" alt="Server vs Client XSS" src="/web-security/assets/images/server-client-xss-3daacf43c827bf4c99acd98b41e895a8.png" width="914" height="684" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="defense-mechanisms">Defense Mechanisms<a class="hash-link" href="#defense-mechanisms" title="Direct link to heading">​</a></h2><ol><li><strong>Filter input on arrival.</strong> At the point where user input is received, filter as strictly as possible based on what is expected or valid input.</li><li><strong>Encode data on output.</strong> At the point where user-controllable data is output in HTTP responses, encode the output to prevent it from being interpreted as active content. Depending on the output context, this might require applying combinations of HTML, URL, JavaScript, and CSS encoding.</li><li><strong>Use appropriate response headers.</strong> To prevent XSS in HTTP responses that aren&#x27;t intended to contain any HTML or JavaScript, you can use the <code>Content-Type</code> and <code>X-Content-Type-Options</code> headers to ensure that browsers interpret the responses in the way you intend.</li><li><strong>Content Security Policy.</strong> Use Content Security Policy (CSP) to reduce the severity of any XSS vulnerabilities that still occur.</li><li><strong>Continuous database scanning.</strong> For stored XSS is common practice to scan the database at regulated intervals, although XSS payloads can be written in multiple formats (base64, binary etc.).</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="other-xss">Other XSS<a class="hash-link" href="#other-xss" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="self-xss">Self XSS<a class="hash-link" href="#self-xss" title="Direct link to heading">​</a></h3><p>Self XSS is a social engineering attack used to gain access to victim&#x27;s web accounts. The victim is tricked into running malicious JavaScript code into their own browser, in web developer console, which can either exfiltrate data or perform actions on behalf of the user.
This is not a code injection vulnerability as each website is vulnerable to this type of attack. In order to prevent this, websites add warning messages in console. In the image below, there are two examples, from Google Meet and Facebook.</p><p><img loading="lazy" alt="Self XSS" src="/web-security/assets/images/self-xss-c6343af9c69fc17e46c3e135ab7e19bf.png" width="695" height="423" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mutated-xss">Mutated XSS<a class="hash-link" href="#mutated-xss" title="Direct link to heading">​</a></h3><p>Mutated XSS happens when the browser tries to fix and rewrite invaild HTML but fails doing so thus executing attacker&#x27;s code. Because it depends from browser to browser, is extremely hard to detect or sanitize within the websites application logic. At the end of this page you will find a video explaining a mXSS on Google Search, and also check the link for one of the first papers describing mXSS attacks.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-dvwa">1. DVWA<a class="hash-link" href="#1-dvwa" title="Direct link to heading">​</a></h3><p>We will use Damn Vulnerable Web Application (DVWA) for this one. You may install it however you want, just to work, but a simple way to do it is by using Docker. Once you <a href="https://docs.docker.com/engine/install/" target="_blank" rel="noopener noreferrer">installed</a> docker you must run</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run --rm -it -p </span><span class="token number" style="color:#36acaa">8080</span><span class="token plain">:80 vulnerables/web-dvwa</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To access the app, go to http://localhost:8080/setup.php and click on <code>Create/Reset Database</code>. Login with username <code>admin</code> and password <code>password</code>.</p><p>DVWA has multipe vulnerable components, but today we will use the XSS related ones. The app has 4 levels of security that can be changed from &#x27;DVWA Security&#x27; section.
All the DVWA challenges allow you to view the PHP source of the page to get additional info about the back-end script. However, in a real-world scenario you won&#x27;t have that kind of access, so please use this functionality only after you have finished the challenge.</p><p>The goal of this challenges is to rise an <code>alert(1)</code> from JavaScript like this:
<img loading="lazy" alt="DVWA Alert 1" src="/web-security/assets/images/dvwa-alert-1-92d3e951d80b485e6898fe604b9df479.png" width="899" height="582" class="img_ev3q"></p><p>With the security level set on <strong>low</strong> you will have to go through each XSS type. Raise the alert, then change the security level to <strong>medium</strong> and then <strong>high</strong>. After you are done with this, change on <strong>impossible</strong> and click on <code>View Source</code>. Why an exploit is not possible in this case? Check the PHP documentation to understand why.</p><p>Go thgough each on in the following order: Reflected, Stored, DOM</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-xss-challenges">2. XSS Challenges<a class="hash-link" href="#2-xss-challenges" title="Direct link to heading">​</a></h3><p>You have 6 levels to finish here: <a href="https://xss-game.appspot.com/" target="_blank" rel="noopener noreferrer">https://xss-game.appspot.com/</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-even-more-xss-challenges">3. Even more XSS Challenges<a class="hash-link" href="#3-even-more-xss-challenges" title="Direct link to heading">​</a></h3><p><a href="https://alf.nu/alert1" target="_blank" rel="noopener noreferrer">https://alf.nu/alert1</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-if-you-get-here">4. If you get here<a class="hash-link" href="#4-if-you-get-here" title="Direct link to heading">​</a></h3><p><a href="http://prompt.ml/0" target="_blank" rel="noopener noreferrer">http://prompt.ml/0</a></p><p><a href="https://xss-quiz.int21h.jp/" target="_blank" rel="noopener noreferrer">https://xss-quiz.int21h.jp/</a></p><p><a href="http://sudo.co.il/xss/" target="_blank" rel="noopener noreferrer">http://sudo.co.il/xss/</a></p><p>Those should be enough to suck the soul out of you.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><ul><li><a href="https://owasp.org/www-community/attacks/xss/" target="_blank" rel="noopener noreferrer">https://owasp.org/www-community/attacks/xss/</a></li><li><a href="https://portswigger.net/web-security/cross-site-scripting" target="_blank" rel="noopener noreferrer">https://portswigger.net/web-security/cross-site-scripting</a></li><li><a href="https://pentest-tools.com/blog/xss-attacks-practical-scenarios/" target="_blank" rel="noopener noreferrer">5 Practical Scenarios for XSS Attacks</a></li><li><a href="http://www.xss-payloads.com/payloads.html" target="_blank" rel="noopener noreferrer">XSS Exploit Payloads</a></li><li><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" target="_blank" rel="noopener noreferrer">XSS Cheat Sheet 1</a></li><li><a href="https://owasp.org/www-community/xss-filter-evasion-cheatsheet" target="_blank" rel="noopener noreferrer">XSS Cheat Sheet 2</a></li><li><a href="https://www.youtube.com/watch?v=lG7U3fuNw3A" target="_blank" rel="noopener noreferrer">Mutated XSS on Google Search</a></li><li><a href="https://cure53.de/fp170.pdf" target="_blank" rel="noopener noreferrer">mXSS paper</a></li></ul><hr><h1>Cross-Site Request Forgery (CSRF)</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="intro-1">Intro<a class="hash-link" href="#intro-1" title="Direct link to heading">​</a></h2><p>Cross-site request forgery is a vulnerability in web applications that allows an attacker to trick users into performing actions that they did not intend.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="impact-1">Impact<a class="hash-link" href="#impact-1" title="Direct link to heading">​</a></h2><p>Once again, the impact of the vulnerability is linked with the functionality that the web application provides, but it can range from posting a comment on behalf of the user with an outdated 2008 meme to making payments to attacker&#x27;s wallet to full account takeover.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-does-it-work">How does it work?<a class="hash-link" href="#how-does-it-work" title="Direct link to heading">​</a></h2><p>For a CSRF attack to be possible, three key conditions must be in place:</p><ul><li><strong>A relevant action.</strong> There is an action within the application that the attacker has a reason to induce. This might be a privileged action (such as modifying permissions for other users) or any action on user-specific data (such as changing the user&#x27;s own password).</li><li><strong>Cookie-based session handling.</strong> Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests. There is no other mechanism in place for tracking sessions or validating user requests.</li><li><strong>No unpredictable request parameters.</strong> The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess. For example, when causing a user to change their password, the function is not vulnerable if an attacker needs to know the value of the existing password.</li></ul><p>For example, suppose an application contains a function that lets the user change the email address on their account. When a user performs this action, they make an HTTP request like the following:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">POST /email/change HTTP/1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: vulnerable-website.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: application/x-www-form-urlencoded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Cookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">email=wiener@normal-user.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This meets the conditions required for CSRF:</p><ul><li>The action of changing the email address on a user&#x27;s account is of interest to an attacker. Following this action, the attacker will typically be able to trigger a password reset and take full control of the user&#x27;s account.</li><li>The application uses a session cookie to identify which user issued the request. There are no other tokens or mechanisms in place to track user sessions.</li><li>The attacker can easily determine the values of the request parameters that are needed to perform the action.</li></ul><p>With these conditions in place, the attacker can construct a web page containing the following HTML:</p><div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">form</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">action</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">https://vulnerable-website.com/email/change</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">method</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">POST</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">input</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">type</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">hidden</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">email</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">pwned@evil-user.net</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">form</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">      </span><span class="token script language-javascript dom variable" style="color:#36acaa">document</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript property-access">forms</span><span class="token script language-javascript punctuation" style="color:#393A34">[</span><span class="token script language-javascript number" style="color:#36acaa">0</span><span class="token script language-javascript punctuation" style="color:#393A34">]</span><span class="token script language-javascript punctuation" style="color:#393A34">.</span><span class="token script language-javascript method function property-access" style="color:#d73a49">submit</span><span class="token script language-javascript punctuation" style="color:#393A34">(</span><span class="token script language-javascript punctuation" style="color:#393A34">)</span><span class="token script language-javascript punctuation" style="color:#393A34">;</span><span class="token script language-javascript"></span><br></span><span class="token-line" style="color:#393A34"><span class="token script language-javascript">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">script</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">body</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">html</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prevention">Prevention<a class="hash-link" href="#prevention" title="Direct link to heading">​</a></h2><ul><li>Use SameSite cookie attribute (similar to HTTPOnly and Secure)</li><li>Add a CSRF token for each request that changes the state of the application (e.g. changing password, sending messages) and validate it on backend</li><li>Use user interaction based CSRF defense for sensitive actions such as changing credentials: re-authentication, one-time token, captcha</li><li>Use Cross-origin resource sharing (CORS) headers to prevent CSRF from your website</li><li>GET methods should not change the state of the application. Use appropriate HTTP methods for their intention.</li><li>in-depth list <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">here</a></li></ul><p>If you find an action/request to have a CSRF token don&#x27;t give up to that so easily, there are a number of ways that improper validation of the token will still result in a CSRF vulnerability:</p><ul><li>Validation of CSRF token depends on request method</li><li>Validation of CSRF token depends on token being present</li><li>CSRF token is not tied to the user session</li><li>CSRF token is tied to a non-session cookie</li><li>CSRF token is simply duplicated in a cookie</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="note-1">Note<a class="hash-link" href="#note-1" title="Direct link to heading">​</a></h2><p>You can combine XSS with CSRF :). If you have two websites that share a part of their user base, you can use a XSS vulnerability in one to abuse a CSRF vulnerability in the other one. For example if a company provides two related services (e.g. email and calendar) you can assume that there is a high probability that a user might have accounts on both of the services, making a Stored XSS in one app a great way to exploit a CSRF in the other one.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges-1">Challenges<a class="hash-link" href="#challenges-1" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-dvwa-1">1. DVWA<a class="hash-link" href="#1-dvwa-1" title="Direct link to heading">​</a></h3><p>Using the same setup as for XSS challenges, go to the CSRF page of DVWA and craft URLs that will change the password for the user accessing it for each security level: <strong>low</strong>, <strong>medium</strong>, <strong>hard</strong>. Why a CSRF is not possible for <strong>impossible</strong>?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-portswigger-academy">2. PortSwigger Academy<a class="hash-link" href="#2-portswigger-academy" title="Direct link to heading">​</a></h3><p>You have 8 challenges here: <a href="https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf" target="_blank" rel="noopener noreferrer">https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading-1">Further reading<a class="hash-link" href="#further-reading-1" title="Direct link to heading">​</a></h2><ul><li><a href="https://portswigger.net/web-security/csrf" target="_blank" rel="noopener noreferrer">https://portswigger.net/web-security/csrf</a></li><li><a href="https://owasp.org/www-community/attacks/csrf" target="_blank" rel="noopener noreferrer">https://owasp.org/www-community/attacks/csrf</a></li><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html" target="_blank" rel="noopener noreferrer">CSRF Prevention Cheat Sheet</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/web-security/Web Application Security/Cross-Site Scripting/Reading/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Reading</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web-security/Web Application Security/Cross-Site Scripting/cross-site-scripting"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">cross-site-scripting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intro" class="table-of-contents__link toc-highlight">Intro</a></li><li><a href="#impact" class="table-of-contents__link toc-highlight">Impact</a></li><li><a href="#types" class="table-of-contents__link toc-highlight">Types</a><ul><li><a href="#reflected-xss" class="table-of-contents__link toc-highlight">Reflected XSS</a></li><li><a href="#stored-xss" class="table-of-contents__link toc-highlight">Stored XSS</a></li><li><a href="#dom-xss" class="table-of-contents__link toc-highlight">DOM XSS</a></li></ul></li><li><a href="#note" class="table-of-contents__link toc-highlight">Note</a></li><li><a href="#defense-mechanisms" class="table-of-contents__link toc-highlight">Defense Mechanisms</a></li><li><a href="#other-xss" class="table-of-contents__link toc-highlight">Other XSS</a><ul><li><a href="#self-xss" class="table-of-contents__link toc-highlight">Self XSS</a></li><li><a href="#mutated-xss" class="table-of-contents__link toc-highlight">Mutated XSS</a></li></ul></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#1-dvwa" class="table-of-contents__link toc-highlight">1. DVWA</a></li><li><a href="#2-xss-challenges" class="table-of-contents__link toc-highlight">2. XSS Challenges</a></li><li><a href="#3-even-more-xss-challenges" class="table-of-contents__link toc-highlight">3. Even more XSS Challenges</a></li><li><a href="#4-if-you-get-here" class="table-of-contents__link toc-highlight">4. If you get here</a></li></ul></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further reading</a></li><li><a href="#intro-1" class="table-of-contents__link toc-highlight">Intro</a></li><li><a href="#impact-1" class="table-of-contents__link toc-highlight">Impact</a></li><li><a href="#how-does-it-work" class="table-of-contents__link toc-highlight">How does it work?</a></li><li><a href="#prevention" class="table-of-contents__link toc-highlight">Prevention</a></li><li><a href="#note-1" class="table-of-contents__link toc-highlight">Note</a></li><li><a href="#challenges-1" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#1-dvwa-1" class="table-of-contents__link toc-highlight">1. DVWA</a></li><li><a href="#2-portswigger-academy" class="table-of-contents__link toc-highlight">2. PortSwigger Academy</a></li></ul></li><li><a href="#further-reading-1" class="table-of-contents__link toc-highlight">Further reading</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security.cs.pub.ro/summer-school/wiki/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 SSS Team</div></div></div></footer></div>
<script src="/web-security/assets/js/runtime~main.8db9aea3.js"></script>
<script src="/web-security/assets/js/main.13eefe83.js"></script>
</body>
</html>