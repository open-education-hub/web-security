<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Network and communication security/Securing communication/Reading/README">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Securing Communication | Web Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://localhost//web-security/Network and communication security/Securing communication/Reading/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Securing Communication | Web Security"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="canonical" href="http://localhost//web-security/Network and communication security/Securing communication/Reading/"><link data-rh="true" rel="alternate" href="http://localhost//web-security/Network and communication security/Securing communication/Reading/" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost//web-security/Network and communication security/Securing communication/Reading/" hreflang="x-default"><link rel="stylesheet" href="/web-security/assets/css/styles.a69a9d41.css">
<link rel="preload" href="/web-security/assets/js/runtime~main.98165a6d.js" as="script">
<link rel="preload" href="/web-security/assets/js/main.165b39f3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web-security/"><div class="navbar__logo"><img src="/web-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/web-security/img/logo.svg" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Web Security</b></a><a class="navbar__item navbar__link" href="/web-security/Web Application Security">Web Application Security</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web-security/Network and communication security">Network and communication security</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/web-security/Web Application Security/">Web Application Security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Web Application Security&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/web-security/Network and communication security/">Network and communication security</a><button aria-label="Toggle the collapsible sidebar category &#x27;Network and communication security&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/web-security/Network and communication security/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/web-security/Network and communication security/Securing communication/">Securing communication</a><button aria-label="Toggle the collapsible sidebar category &#x27;Securing communication&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" aria-expanded="true" tabindex="0" href="/web-security/Network and communication security/Securing communication/Reading/">Reading</a><button aria-label="Toggle the collapsible sidebar category &#x27;Reading&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web-security/Network and communication security/Securing communication/Reading/">Introduction</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web-security/Network and communication security/Securing communication/securing-communication">Slides</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/web-security/Network and communication security/Enumeration and Recon/">Enumeration and Recon</a><button aria-label="Toggle the collapsible sidebar category &#x27;Enumeration and Recon&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/web-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web-security/Network and communication security/"><span itemprop="name">Network and communication security</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web-security/Network and communication security/Securing communication/"><span itemprop="name">Securing communication</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Reading</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Securing Communication</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>As part of this session, we look into how HTTP connections can be made secure, to prevent attacks that capture traffic, also called <a href="https://www.thesslstore.com/blog/man-in-the-middle-attack-2/" target="_blank" rel="noopener noreferrer">man-in-the-middle (MitM) attacks</a>.
The session is focused on understanding certificates and HTTPS and investigating configurations of existing setups.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="reminders-and-prerequisites">Reminders and Prerequisites<a class="hash-link" href="#reminders-and-prerequisites" title="Direct link to heading">​</a></h2><p>HTTP (<em>Hypertext Transfer Protocol</em>) is the main protocol of the web.
It has several characteristics:</p><ul><li>it is plain text</li><li>it doesn&#x27;t maintain an active connection</li><li>it&#x27;s a request-response protocol</li><li>it provides a series of codes to mark the types of requests and replies</li><li>HTTP requests consists of paths (routes) that are mapped to resources</li></ul><p>The lack of an active connection session is compensated by the use of cookies.
Similarly, the plain text nature of the protocol means that anyone could read contents in HTTP network packets.
This is alleviated by the use of HTTPS.
Nowadays, most connections use HTTPS precisely because of the need for confidentiality.</p><p>In the previous session, you used web browsers and the <a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_are_browser_developer_tools" target="_blank" rel="noopener noreferrer">Developer Tools</a> feature of modern browsers to inspect traffic, update cookies, inspect rendered pages.
GUI web browsers (such as Firefox, Chrome, Edge, Safari) provide the appealing interface for users to surf the web.
For quick and dirty tasks such as testing connections, making requests and downloading large files, we use CLI web clients such as <code>curl</code> and <code>wget</code>.
We will be using these in this session as well.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="confidentiality">Confidentiality<a class="hash-link" href="#confidentiality" title="Direct link to heading">​</a></h2><p>Confidentiality is a security property that prevents captured data from being understood by an attacker.
If an attacker captures data with confidentiality ensured, the attacker must not be able to extract actual information from it.
Confidentiality is generally provided with encryption.</p><p>For example, a classical HTTP connection is plain text and thus non-confidential.
Let&#x27;s exemplify this.
On one terminal, start a <code>tcpdump</code> capture session for HTTP connections:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo tcpdump -A tcp port 80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>On another terminal, make an HTTP connection using <code>curl</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl http://elf.cs.pub.ro</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>As the connection is HTTP, you will see plain text messages as part of the <code>tcpdump</code> output:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Host: elf.cs.pub.ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">User-Agent: curl/7.58.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept: */*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: Sun, 03 Jul 2022 15:51:46 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server: Apache/2.4.38 (Debian)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last-Modified: Mon, 02 Aug 2010 17:58:06 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ETag: &quot;a8-48cdaf14da780&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Accept-Ranges: bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Length: 168</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Vary: Accept-Encoding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Content-Type: text/html</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;meta name=&quot;google-site-verification&quot; content=&quot;gTsIxyV43HSJraRPl6X1A5jzGFgQ3N__hKAcuL2QsO8&quot; /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;h1&gt;It works!&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/body&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/html&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>However, if we used <code>curl</code> and an HTTPS connection:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl https://elf.cs.pub.ro</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>there would be no plain text output on the <code>tcpdump</code> console, because the connection is using a confidential (encrypted) channel.</p><p>The same traffic inspection can be done in a more visual manner using Wireshark.</p><p>As long as traffic is not encrypted, an attacker able to capture packets (either fooling someone to get the data or simply accessing a networking equipment along the way) will read the traffic contents.
HTTPS uses public key cryptography to ensure the confidentiality of network traffic.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="public-key-cryptography-certificates">Public Key Cryptography. Certificates<a class="hash-link" href="#public-key-cryptography-certificates" title="Direct link to heading">​</a></h2><p>There are mainly two types of encryption: symmetric and public-key encryption.</p><p>In symmetric encryption, a key is shared among the two ends in the communication.</p><p><img loading="lazy" alt="symmetric encryption" src="/web-security/assets/images/symmetric-encryption-6e227ad773fb913530bde8ef5d75d770.svg" width="1062" height="662" class="img_ev3q"></p><p>That same key is used for both encrypting and decrypting data.
AES (<em>Advanced Encryption Standard</em>) is the standard symmetric encryption algorithm.
The main benefit of symmetric encryption algorithms is their relative simplicity and speed: they are easy to implement and are fast, with the option of having hardware support.
The downside is related to the shared key.
If the key is captured by an attacker or if it is lost by one of the ends, confidentiality is compromised.</p><p>So, the goal is that each connection should use a temporary shared key.
After the connection ends, the shared key is discarded.
A new connection will generate a new key.
Of course, that shared key must be known only by the two ends.
For this two happen, key exchange algorithms, such as <a href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange" target="_blank" rel="noopener noreferrer">Diffie Hellman</a> are used.</p><p>Diffie-Hellman (often abbreviated as DH) is based on public-key encryption.
In short we use public-key encryption to set up a temporary shared key for the actual communication.</p><p>Public-key encryption, as its name implies, relies on a pair of private and public keys that are connected mathematically.
RSA (<em>Rivest Shamir Adleman</em> - named after its inventors) is the classical public key cryptographic algorithm.
The private key is generated as a random set of bytes and the public key is generated from it, via a mathematical algorithm.
The private key is only available to the owner, whereas the public key is available to everyone.
Anyone can encrypt a message using the public key, but only the owner can decrypt the message using the private key, as shown below.</p><p><img loading="lazy" alt="public-key encryption" src="/web-security/assets/images/public-key-encryption-b45675b5e59900662c4b6ddc98f12202.svg" width="1062" height="670" class="img_ev3q"></p><p>Because of this, public-key encryption is considered more secure than symmetric encryption, as it doesn&#x27;t require the passing of a shared key between parties, an act that may be intercepted.
At the same time, public-key encryption is much slower than symmetric encryption.
Because of this, public-key encryption is only used to set up an initial session and enable a key exchange algorithm (such as Diffie-Hellman) to generate a temporary session-specific shared key.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="identity-management-certificates">Identity Management. Certificates<a class="hash-link" href="#identity-management-certificates" title="Direct link to heading">​</a></h3><p>A public-private key pair is not only used for encryption.
It&#x27;s also used for identity management.</p><p>Identity management means making sure a given entity is who they claim they are.
In HTTPS that means that if we connect to <code>google.com</code> we are offered guarantees that the server we connect to is indeed <code>google.com</code>.
Otherwise, another server could impersonate the target server and capture all traffic.</p><p>Identity management relies on signing and verifying messages using public-private keys.
The private key is used to sign a message.
The signed message is provided publicly.
Then, the public key is used to verify the message.
This is called a <strong>digital signature</strong>, as shown below:</p><p><img loading="lazy" alt="digital signature" src="/web-security/assets/images/digital-signature-8e32778b1008aff82a80c4f076807aba.svg" width="1062" height="670" class="img_ev3q"></p><p>In HTTPS, this means that the web server will sign the message with its private key and web clients will verify the message with the public key.</p><p>In order for this to work, the public key has to be attached the identity: the name of the server.
This is done via a <strong>digital certificate</strong>.
A certificate is a file that consists of a public key and an identity.
A certificate itself is also signed to ensure its validity.
This means that a certificate will also be verified using a public key, found as part of another certificate, as shown below:</p><p><img loading="lazy" alt="digital certificate" src="/web-security/assets/images/digital-certificate-c01404532f2d6f6eeaebdf7712077e2d.png" width="660" height="457" class="img_ev3q"></p><p>This dependency between certificates creates a <strong>public-key infrastructure</strong> (PKI), on top of which self-signed root certificates are located.
Self-signed root certificates part of <strong>Certification Authorities</strong>.
These are entities that sign other certificates to validate the binding of a public key to an identity.</p><p>A browser stores root certificates as part of its default installation.
Each connection to the server will get the server to provide the certificate: identity and public key.
The browser uses the root certificate and intermediary certificates to verify the certificate.
After its verification the public key is used to create the actual HTTPS (secure) connection.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-certificates">Inspecting Certificates<a class="hash-link" href="#inspecting-certificates" title="Direct link to heading">​</a></h3><p>To get a better understanding of how certificates work, let&#x27;s take a look at one.</p><p>In order to get a certificate to inspect, it is easiest to export a root certificate from a browser.
In Firefox, we can use the Certificate Manager, as shown in the image below to export a certificate:</p><p><img loading="lazy" alt="Firefox Certificate Manager" src="/web-security/assets/images/firefox-certificate-manager-01201e4f99a8047f176870214b4bab8c.png" width="962" height="664" class="img_ev3q"></p><p>The CA (root) certificate from Verisign is located in <code>media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt</code>.
The certificate, as most certificates, is exported in PEM (<em>Privacy Enhanced Mail</em>) format, a Base64 encoding:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIEGjCCAwICEQCLW3VWhFSFCwDPrzhIzrGkMA0GCSqGSIb3DQEBBQUAMIHKMQsw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CQYDVQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmlTaWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWdu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LCBJbmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aWduIENsYXNzIDEgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3Jp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dHkgLSBHMzAeFw05OTEwMDEwMDAwMDBaFw0zNjA3MTYyMzU5NTlaMIHKMQswCQYD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VQQGEwJVUzEXMBUGA1UEChMOVmVyaVNpZ24sIEluYy4xHzAdBgNVBAsTFlZlcmlT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aWduIFRydXN0IE5ldHdvcmsxOjA4BgNVBAsTMShjKSAxOTk5IFZlcmlTaWduLCBJ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bmMuIC0gRm9yIGF1dGhvcml6ZWQgdXNlIG9ubHkxRTBDBgNVBAMTPFZlcmlTaWdu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IENsYXNzIDEgUHVibGljIFByaW1hcnkgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LSBHMzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAN2E1Lm0+afY8wR4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nN493GwTFtl63SRRZsDHJlkNrAYIwpTRMx/wgzUfbhvI3qpuFU5UJ+/EbRrsC+MO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8ESlV8dAWB6jRx9x7GD2bZTIGDnt/kIYVt/kTEkQeE4BdjVjEjbdZrwBBDajVWjV</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ojYJrKshJlQGrT/KFOCsyq0GHZXi+J3x4GD/wn91K0zM2v6HmSHquv4+VNfSWXjb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PG7PoBMAGrgnoeS+Z5bKoMWznN3JdZ7rMJpfo83ZrngZPyPpXNspva1VyBtUjGP2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6KbqxzcSXKMpHgLZ2x87tNcPVkeBFQRKr4Mn0cVYiMHd9qqnoxjaaKptEVHhv2Vr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">n5Z20T0CAwEAATANBgkqhkiG9w0BAQUFAAOCAQEAq2aN17O6x5q25lXQBfGfMY1a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qtmqRiYPce2lrVNWYgFHKkTp/j90CxObufRNG7LRX7K20ohcs5/Ny9Sn2WCVhDr4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wTcdYcrnsMXlkdpUpqwxga6X3s0IrLjAl4B/bnKk52kTlWUfxJM8/XmPBNQ+T+r3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ns7NZ3xPZQL/kYVUc8f/NveGLezQXk//EZ9yBta4GvFMDSZl4kSAHsef493oCtrs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pSCAaWihT37ha88HQfqDjrw43bAuEbFrskLMmrz5SCJ5ShkPshw+IHTZasO+8ih4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E1Z5T21Q6huwtVexN2ZYI/PcD98Kh8TvhgXVOBRgmaNL3gaWcSzy27YfpO8/7g==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In its basic format, the certificate is a binary file.
The PEM format is used to make it printable.
The PEM format is also used for storing private and public SSH keys, so it may seem familiar.</p><p>We can inspect the certificate with <code>openssl</code>:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -text -in media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certificate:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Data:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Version: 1 (0x0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Serial Number:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            8b:5b:75:56:84:54:85:0b:00:cf:af:38:48:ce:b1:a4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Signature Algorithm: sha1WithRSAEncryption</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Issuer: C = US, O = &quot;VeriSign, Inc.&quot;, OU = VeriSign Trust Network, OU = &quot;(c) 1999 VeriSign, Inc. - For authorized use only&quot;, CN = VeriSign Class 1 Public Primary Certification Authority - G3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Validity</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Not Before: Oct  1 00:00:00 1999 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Not After : Jul 16 23:59:59 2036 GMT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Subject: C = US, O = &quot;VeriSign, Inc.&quot;, OU = VeriSign Trust Network, OU = &quot;(c) 1999 VeriSign, Inc. - For authorized use only&quot;, CN = VeriSign Class 1 Public Primary Certification Authority - G3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Subject Public Key Info:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Public Key Algorithm: rsaEncryption</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                RSA Public-Key: (2048 bit)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Modulus:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    00:dd:84:d4:b9:b4:f9:a7:d8:f3:04:78:9c:de:3d:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    dc:6c:13:16:d9:7a:dd:24:51:66:c0:c7:26:59:0d:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    ac:06:08:c2:94:d1:33:1f:f0:83:35:1f:6e:1b:c8:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    de:aa:6e:15:4e:54:27:ef:c4:6d:1a:ec:0b:e3:0e:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    f0:44:a5:57:c7:40:58:1e:a3:47:1f:71:ec:60:f6:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    6d:94:c8:18:39:ed:fe:42:18:56:df:e4:4c:49:10:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    78:4e:01:76:35:63:12:36:dd:66:bc:01:04:36:a3:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    55:68:d5:a2:36:09:ac:ab:21:26:54:06:ad:3f:ca:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    14:e0:ac:ca:ad:06:1d:95:e2:f8:9d:f1:e0:60:ff:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    c2:7f:75:2b:4c:cc:da:fe:87:99:21:ea:ba:fe:3e:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    54:d7:d2:59:78:db:3c:6e:cf:a0:13:00:1a:b8:27:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    a1:e4:be:67:96:ca:a0:c5:b3:9c:dd:c9:75:9e:eb:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    30:9a:5f:a3:cd:d9:ae:78:19:3f:23:e9:5c:db:29:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    bd:ad:55:c8:1b:54:8c:63:f6:e8:a6:ea:c7:37:12:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    5c:a3:29:1e:02:d9:db:1f:3b:b4:d7:0f:56:47:81:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    15:04:4a:af:83:27:d1:c5:58:88:c1:dd:f6:aa:a7:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    a3:18:da:68:aa:6d:11:51:e1:bf:65:6b:9f:96:76:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    d1:3d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Exponent: 65537 (0x10001)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Signature Algorithm: sha1WithRSAEncryption</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ab:66:8d:d7:b3:ba:c7:9a:b6:e6:55:d0:05:f1:9f:31:8d:5a:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         aa:d9:aa:46:26:0f:71:ed:a5:ad:53:56:62:01:47:2a:44:e9:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         fe:3f:74:0b:13:9b:b9:f4:4d:1b:b2:d1:5f:b2:b6:d2:88:5c:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         b3:9f:cd:cb:d4:a7:d9:60:95:84:3a:f8:c1:37:1d:61:ca:e7:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         b0:c5:e5:91:da:54:a6:ac:31:81:ae:97:de:cd:08:ac:b8:c0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         97:80:7f:6e:72:a4:e7:69:13:95:65:1f:c4:93:3c:fd:79:8f:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         04:d4:3e:4f:ea:f7:9e:ce:cd:67:7c:4f:65:02:ff:91:85:54:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         73:c7:ff:36:f7:86:2d:ec:d0:5e:4f:ff:11:9f:72:06:d6:b8:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         1a:f1:4c:0d:26:65:e2:44:80:1e:c7:9f:e3:dd:e8:0a:da:ec:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         a5:20:80:69:68:a1:4f:7e:e1:6b:cf:07:41:fa:83:8e:bc:38:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         dd:b0:2e:11:b1:6b:b2:42:cc:9a:bc:f9:48:22:79:4a:19:0f:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         b2:1c:3e:20:74:d9:6a:c3:be:f2:28:78:13:56:79:4f:6d:50:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ea:1b:b0:b5:57:b1:37:66:58:23:f3:dc:0f:df:0a:87:c4:ef:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         86:05:d5:38:14:60:99:a3:4b:de:06:96:71:2c:f2:db:b6:1f:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         a4:ef:3f:ee</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The options passed to the <code>openssl</code> command are:</p><ul><li><code>x509</code>: work with X.509 certificates - a standard for certificates</li><li><code>-noout</code>: do not print the PEM output of the certificate</li><li><code>-text</code>: print as text the contents of the certificate</li><li><code>-in</code>: the input certificate file</li></ul><p>As shown in the output, a certificate comprises of data and the signature of that data.
The data is primarily composed of the:</p><ul><li>identity (the <code>Subject</code> attribute): <code>C = US, O = &quot;VeriSign, Inc.&quot;, OU = VeriSign Trust Network, OU = &quot;(c) 1999 VeriSign, Inc. - For authorized use only&quot;, CN = VeriSign Class 1 Public Primary Certification Authority - G3</code></li><li>the public key (comprised of a <code>Modulus</code> and <code>Exponent</code>)</li></ul><p>There are two other important items:</p><ul><li>the issuer, i.e. the entity that signed the certificate;
in this case, it&#x27;s a self signed certificate, so the <code>Issuer</code> is the same as the <code>Subject</code></li><li>the validity of the certificate, in this case it&#x27;s <code>July 16, 2036</code></li></ul><p>Generally, a certificate is only valid for one year and then it will have to be renewed.
Renewing means a new public key is generated and, together with the same identity information, a new certificate.</p><p>The <code>openssl</code> utility has command-line options to only print parts of the certificate.
For example, to only print the issuer or the public key, we would use the <code>-issuer</code> or <code>-pubkey</code> options:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -issuer -in media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuer=C = US, O = &quot;VeriSign, Inc.&quot;, OU = VeriSign Trust Network, OU = &quot;(c) 1999 VeriSign, Inc. - For authorized use only&quot;, CN = VeriSign Class 1 Public Primary Certification Authority - G3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -pubkey -in media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN PUBLIC KEY-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3YTUubT5p9jzBHic3j3c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bBMW2XrdJFFmwMcmWQ2sBgjClNEzH/CDNR9uG8jeqm4VTlQn78RtGuwL4w7wRKVX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x0BYHqNHH3HsYPZtlMgYOe3+QhhW3+RMSRB4TgF2NWMSNt1mvAEENqNVaNWiNgms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qyEmVAatP8oU4KzKrQYdleL4nfHgYP/Cf3UrTMza/oeZIeq6/j5U19JZeNs8bs+g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EwAauCeh5L5nlsqgxbOc3cl1nuswml+jzdmueBk/I+lc2ym9rVXIG1SMY/bopurH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NxJcoykeAtnbHzu01w9WR4EVBEqvgyfRxViIwd32qqejGNpoqm0RUeG/ZWuflnbR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PQIDAQAB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END PUBLIC KEY-----</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="verifying-certificates">Verifying Certificates<a class="hash-link" href="#verifying-certificates" title="Direct link to heading">​</a></h3><p>As the VeriSign certificate is self-signed, we can use it to verify itself:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl verify -CAfile media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt media/VerisignClass1PublicPrimaryCertificationAuthority-G3.crt: OK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <code>-CAfile</code> option points to the CA certificate to verify the current one.
As this is is a self signed certificate, we use itself as CA.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="https-ssl-and-tls">HTTPS, SSL and TLS<a class="hash-link" href="#https-ssl-and-tls" title="Direct link to heading">​</a></h2><p>HTTPS is the secure version of HTTP providing identity management, confidentiality and integrity.
HTTPS relies on at least the HTTP server providing a certificate that validates the identity.
The client can also do that, as part of <a href="https://comodosslstore.com/blog/what-is-ssl-tls-client-authentication-how-does-it-work.html" target="_blank" rel="noopener noreferrer">client certificate authentication</a>.</p><p>After validating the identity of the server, the client-server pair create a secure channel by agreeing on a per-session shared symmetric encryption key.
This is negotiated via a key-exchange algorithm such as Diffie-Hellman.
Then, all traffic between client and server will be encrypted.</p><p>This entire process is facilitated by the use of SSL (<em>Secure Sockets Layer</em>) or TLS (<em>Transport Layer Security</em>).
We say that HTTPS is HTTP plus SSL / TLS support.
Note that this is the case with other secure protocol variants such as SMTPS, IMAPS, LDAPS.</p><p>SSL / TLS usually refer to the same thing.
TLS is a newer version of the protocol.
Version are SSL1.0, SSL2.0, SSL3.0, TLS1.0, TLS1.1, TLS1.2, TLS1.3.
Each newer version comes with fixes and extra security guarantees.
Nowadays (2022) all SSL versions and TLS1.0 are considered insecure.
This is due both to internal design issues and to weak cryptographic algorithms or the allowing cryptographic keys of insufficient size.</p><p>A summary of attacks on SSL / TLS is summarized as part of <a href="https://tools.ietf.org/html/rfc7457" target="_blank" rel="noopener noreferrer">RFC 7457</a>.
Additional information can be found <a href="https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://www.cloudinsidr.com/content/known-attack-vectors-against-tls-implementation-vulnerabilities/" target="_blank" rel="noopener noreferrer">here</a>.
Well known SSL / TLS attacks are:</p><ul><li><a href="https://weakdh.org/logjam.html" target="_blank" rel="noopener noreferrer">Logjam</a></li><li><a href="http://backronym.fail/" target="_blank" rel="noopener noreferrer">BACKRONYM</a></li><li><a href="https://drownattack.com/" target="_blank" rel="noopener noreferrer">DROWN</a></li></ul><p>A typical target of the attacker is downgrading the connection from HTTPS to HTTP.
Or downgrading the SSL / TLS protocol version to a less secure variant.
Read more on protocol downgrade <a href="https://www.venafi.com/blog/preventing-downgrade-attacks" target="_blank" rel="noopener noreferrer">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="capturing-inspecting-and-verifying-https-certificates">Capturing, Inspecting and Verifying HTTPS Certificates<a class="hash-link" href="#capturing-inspecting-and-verifying-https-certificates" title="Direct link to heading">​</a></h3><p>If you want to extract and inspect the certificate of an HTTPS server we would use the command below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl s_client -showcerts -connect www.google.com:443 -servername www.google.com &lt; /dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONNECTED(00000005)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">depth=2 C = US, O = Google Trust Services LLC, CN = GTS Root R1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">verify return:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">depth=1 C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">verify return:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">depth=0 CN = www.google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">verify return:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Certificate chain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0 s:CN = www.google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   i:C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIEiTCCA3GgAwIBAgIRAJ8HSxF0Xxb8EiN1+lh5k/AwDQYJKoZIhvcNAQELBQAw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RjELMAkGA1UEBhMCVVMxIjAgBgNVBAoTGUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEMxEzARBgNVBAMTCkdUUyBDQSAxQzMwHhcNMjIwNjA2MDk0MDAwWhcNMjIwODI5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MDkzOTU5WjAZMRcwFQYDVQQDEw53d3cuZ29vZ2xlLmNvbTBZMBMGByqGSM49AgEG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CCqGSM49AwEHA0IABD8O7cXWSPQhh/GihqJi+gdtpS0vAt2GeDRHBaVeB8x5dDtx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3us2TGW2WJGfC7VeSVHCX1uDXkjAIOTauMUjCu2jggJoMIICZDAOBgNVHQ8BAf8E</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDAYDVR0TAQH/BAIwADAdBgNVHQ4E</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FgQUWVwHKuk+m9ZD0/h/+Jsgactucp8wHwYDVR0jBBgwFoAUinR/r4XN7pXNPZzQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4kYU83E1HScwagYIKwYBBQUHAQEEXjBcMCcGCCsGAQUFBzABhhtodHRwOi8vb2Nz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cC5wa2kuZ29vZy9ndHMxYzMwMQYIKwYBBQUHMAKGJWh0dHA6Ly9wa2kuZ29vZy9y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZXBvL2NlcnRzL2d0czFjMy5kZXIwGQYDVR0RBBIwEIIOd3d3Lmdvb2dsZS5jb20w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IQYDVR0gBBowGDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAzMDGg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L6AthitodHRwOi8vY3Jscy5wa2kuZ29vZy9ndHMxYzMvUU92SjBOMXNUMkEuY3Js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIBBQYKKwYBBAHWeQIEAgSB9gSB8wDxAHYAUaOw9f0BeZxWbbg3eI8MpHrMGyfL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">956IQpoN/tSLBeUAAAGBOJmjFwAABAMARzBFAiEA7Pub0IWm5kMWJrfJGLqP4lZU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">71J6No/RLMwsvXWzVfACICJMzt/AFBsNQ1t970tVRnhmgsgz2s6deykihInBRfZR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AHcARqVV63X6kSAwtaKJafTzfREsQXS+/Um4havy/HD+bUcAAAGBOJmjPwAABAMA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SDBGAiEA92vym4NTX/SmjhAx7ICLE4KXpQFsWfhvRf1m5B6qby8CIQCVyyWh2t22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UhaaKSS+nIypJ9jWtOO4wG1gVkty8c/XETANBgkqhkiG9w0BAQsFAAOCAQEAI8fX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MKLNXXoMJk6WTJvV1ORE6kYVtyZm0wM64yV9V1zmksWDgOx9xHmoAUTQYeSq6rhI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tTxgb9EmDF8gVrOXwY31WpWjJyJQAfQcn3LhPUzJnr8yqyiwfVD1FG5gKQTTlblr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g9sZ+zfETFPXTFJeGT5yBxcT8xQDQNERblVkaQ1H5f2XYuXAJJ4vlNCu7AFil1tp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">U4bau/EfQPx5Jd1bLxJwbeF9FbuQvcMeow+4ElcpC5BSkzsRk7lUbZfj7NWZas5t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3yp0UncNl+Pib3p0ooLDJ3HQvlQuL4AAg2nYkL+UKusZ9d/22RmbiyGkqr+3L/3+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PKvAVy9/DNPwW3YUbQ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1 s:C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   i:C = US, O = Google Trust Services LLC, CN = GTS Root R1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIFljCCA36gAwIBAgINAgO8U1lrNMcY9QFQZjANBgkqhkiG9w0BAQsFADBHMQsw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MBIGA1UEAxMLR1RTIFJvb3QgUjEwHhcNMjAwODEzMDAwMDQyWhcNMjcwOTMwMDAw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MDQyWjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Y2VzIExMQzETMBEGA1UEAxMKR1RTIENBIDFDMzCCASIwDQYJKoZIhvcNAQEBBQAD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggEPADCCAQoCggEBAPWI3+dijB43+DdCkH9sh9D7ZYIl/ejLa6T/belaI+KZ9hzp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kgOZE3wJCor6QtZeViSqejOEH9Hpabu5dOxXTGZok3c3VVP+ORBNtzS7XyV3NzsX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lOo85Z3VvMO0Q+sup0fvsEQRY9i0QYXdQTBIkxu/t/bgRQIh4JZCF8/ZK2VWNAcm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BA2o/X3KLu/qSHw3TT8An4Pf73WELnlXXPxXbhqW//yMmqaZviXZf5YsBvcRKgKA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gOtjGDxQSYflispfGStZloEAoPtR28p3CwvJlk/vcEnHXG0g/Zm0tOLKLnf9LdwL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmsTDIwZKxeWmLnwi/agJ7u2441Rj72ux5uxiZ0CAwEAAaOCAYAwggF8MA4GA1Ud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwEgYDVR0T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUinR/r4XN7pXNPZzQ4kYU83E1HScwHwYD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VR0jBBgwFoAU5K8rJnEaK0gnhS9SZizv8IkTcT4waAYIKwYBBQUHAQEEXDBaMCYG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CCsGAQUFBzABhhpodHRwOi8vb2NzcC5wa2kuZ29vZy9ndHNyMTAwBggrBgEFBQcw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AoYkaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3RzcjEuZGVyMDQGA1UdHwQt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MCswKaAnoCWGI2h0dHA6Ly9jcmwucGtpLmdvb2cvZ3RzcjEvZ3RzcjEuY3JsMFcG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A1UdIARQME4wOAYKKwYBBAHWeQIFAzAqMCgGCCsGAQUFBwIBFhxodHRwczovL3Br</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aS5nb29nL3JlcG9zaXRvcnkvMAgGBmeBDAECATAIBgZngQwBAgIwDQYJKoZIhvcN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AQELBQADggIBAIl9rCBcDDy+mqhXlRu0rvqrpXJxtDaV/d9AEQNMwkYUuxQkq/BQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cSLbrcRuf8/xam/IgxvYzolfh2yHuKkMo5uhYpSTld9brmYZCwKWnvy15xBpPnrL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RklfRuFBsdeYTWU0AIAaP0+fbH9JAIFTQaSSIYKCGvGjRFsqUBITTcFTNvNCCK9U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+o53UxtkOCcXCb1YyRt8OS1b887U7ZfbFAO/CVMkH8IMBHmYJvJh8VNS/UKMG2Yr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PxWhu//2m+OBmgEGcYk1KCTd4b3rGS3hSMs9WYNRtHTGnXzGsYZbr8w0xNPM1IER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lQCh9BIiAfq0g3GvjLeMcySsN1PCAJA/Ef5c7TaUEDu9Ka7ixzpiO2xj2YC/WXGs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Yye5TBeg2vZzFb8q3o/zpWwygTMD0IZRcZk0upONXbVRWPeyk+gB9lm+cZv9TSjO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">z23HFtz30dZGm6fKa+l3D/2gthsjgx0QGtkJAITgRNOidSOzNIb2ILCkXhAd4FJG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AJ2xDx8hcFH1mt0G/FX0Kw4zd8NLQsLxdxP8c4CU6x+7Nz/OAipmsHMdMqUybDKw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">juDEI/9bfU1lcKwrmz3O2+BtjjKAvpafkmO8l7tdufThcV4q5O8DIrGKZTqPwJNl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1IXNDw9bg1kWRxYtnCQ6yICmJhSFm/Y3m6xv+cXDBlHz4n/FsRC6UfTd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2 s:C = US, O = Google Trust Services LLC, CN = GTS Root R1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   i:C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIFYjCCBEqgAwIBAgIQd70NbNs2+RrqIQ/E8FjTDTANBgkqhkiG9w0BAQsFADBX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBudi1zYTEQMA4GA1UE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CxMHUm9vdCBDQTEbMBkGA1UEAxMSR2xvYmFsU2lnbiBSb290IENBMB4XDTIwMDYx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OTAwMDA0MloXDTI4MDEyODAwMDA0MlowRzELMAkGA1UEBhMCVVMxIjAgBgNVBAoT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBMTEMxFDASBgNVBAMTC0dUUyBSb290IFIx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAthECix7joXebO9y/lD63</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ladAPKH9gvl9MgaCcfb2jH/76Nu8ai6Xl6OMS/kr9rH5zoQdsfnFl97vufKj6bwS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iV6nqlKr+CMny6SxnGPb15l+8Ape62im9MZaRw1NEDPjTrETo8gYbEvs/AmQ351k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KSUjB6G00j0uYODP0gmHu81I8E3CwnqIiru6z1kZ1q+PsAewnjHxgsHA3y6mbWwZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DrXYfiYaRQM9sHmklCitD38m5agI/pboPGiUU+6DOogrFZYJsuB6jC511pzrp1Zk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">j5ZPaK49l8KEj8C8QMALXL32h7M1bKwYUH+E4EzNktMg6TO8UpmvMrUpsyUqtEj5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cuHKZPfmghCN6J3Cioj6OGaK/GP5Afl4/Xtcd/p2h/rs37EOeZVXtL0m79YB0esW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CruOC7XFxYpVq9Os6pFLKcwZpDIlTirxZUTQAs6qzkm06p98g7BAe+dDq6dso499</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iYH6TKX/1Y7DzkvgtdizjkXPdsDtQCv9Uw+wp9U7DbGKogPeMa3Md+pvez7W35Ei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eua++tgy/BBjFFFy3l3WFpO9KWgz7zpm7AeKJt8T11dleCfeXkkUAKIAf5qoIbap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sZWwpbkNFhHax2xIPEDgfg1azVY80ZcFuctL7TlLnMQ/0lUTbiSw1nH69MG6zO0b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9f6BQdgAmD06yK56mDcYBZUCAwEAAaOCATgwggE0MA4GA1UdDwEB/wQEAwIBhjAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBTkrysmcRorSCeFL1JmLO/wiRNxPjAf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BgNVHSMEGDAWgBRge2YaRQ2XyolQL30EzTSo//z9SzBgBggrBgEFBQcBAQRUMFIw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JQYIKwYBBQUHMAGGGWh0dHA6Ly9vY3NwLnBraS5nb29nL2dzcjEwKQYIKwYBBQUH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAKGHWh0dHA6Ly9wa2kuZ29vZy9nc3IxL2dzcjEuY3J0MDIGA1UdHwQrMCkwJ6Al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oCOGIWh0dHA6Ly9jcmwucGtpLmdvb2cvZ3NyMS9nc3IxLmNybDA7BgNVHSAENDAy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAgGBmeBDAECATAIBgZngQwBAgIwDQYLKwYBBAHWeQIFAwIwDQYLKwYBBAHWeQIF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AwMwDQYJKoZIhvcNAQELBQADggEBADSkHrEoo9C0dhemMXoh6dFSPsjbdBZBiLg9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NR3t5P+T4Vxfq7vqfM/b5A3Ri1fyJm9bvhdGaJQ3b2t6yMAYN/olUazsaL+yyEn9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WprKASOshIArAoyZl+tJaox118fessmXn1hIVw41oeQa1v1vg4Fv74zPl6/AhSrw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9U5pCZEt4Wi4wStz6dTZ/CLANx8LZh1J7QJVj2fhMtfTJr9w4z30Z209fOU0iOMy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+qduBmpvvYuR7hZL6Dupszfnw0Skfths18dG9ZKb59UhvmaSGZRVbNQpsg3BZlvi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d0lIKO2d1xozclOzgjXPYovJJIultzkMu34qQb9Sz/yilrbCgj8=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server certificate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subject=CN = www.google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuer=C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No client certificate CA names sent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Peer signing digest: SHA256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Peer signature type: ECDSA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server Temp Key: X25519, 253 bits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SSL handshake has read 4295 bytes and written 396 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verification: OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Server public key is 256 bit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Secure Renegotiation IS NOT supported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Compression: NONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Expansion: NONE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">No ALPN negotiated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Early data was not sent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verify return code: 0 (ok)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DONE</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The command is pretty verbose.
We can make it print just the certificates by using:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl s_client -showcerts -connect www.google.com:443 -servername www.google.com &lt; /dev/null 2&gt; /dev/null | sed -ne &#x27;/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIEiTCCA3GgAwIBAgIRAJ8HSxF0Xxb8EiN1+lh5k/AwDQYJKoZIhvcNAQELBQAw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RjELMAkGA1UEBhMCVVMxIjAgBgNVBAoTGUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TEMxEzARBgNVBAMTCkdUUyBDQSAxQzMwHhcNMjIwNjA2MDk0MDAwWhcNMjIwODI5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MDkzOTU5WjAZMRcwFQYDVQQDEw53d3cuZ29vZ2xlLmNvbTBZMBMGByqGSM49AgEG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CCqGSM49AwEHA0IABD8O7cXWSPQhh/GihqJi+gdtpS0vAt2GeDRHBaVeB8x5dDtx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3us2TGW2WJGfC7VeSVHCX1uDXkjAIOTauMUjCu2jggJoMIICZDAOBgNVHQ8BAf8E</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BAMCB4AwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDAYDVR0TAQH/BAIwADAdBgNVHQ4E</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FgQUWVwHKuk+m9ZD0/h/+Jsgactucp8wHwYDVR0jBBgwFoAUinR/r4XN7pXNPZzQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4kYU83E1HScwagYIKwYBBQUHAQEEXjBcMCcGCCsGAQUFBzABhhtodHRwOi8vb2Nz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cC5wa2kuZ29vZy9ndHMxYzMwMQYIKwYBBQUHMAKGJWh0dHA6Ly9wa2kuZ29vZy9y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ZXBvL2NlcnRzL2d0czFjMy5kZXIwGQYDVR0RBBIwEIIOd3d3Lmdvb2dsZS5jb20w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IQYDVR0gBBowGDAIBgZngQwBAgEwDAYKKwYBBAHWeQIFAzA8BgNVHR8ENTAzMDGg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">L6AthitodHRwOi8vY3Jscy5wa2kuZ29vZy9ndHMxYzMvUU92SjBOMXNUMkEuY3Js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIBBQYKKwYBBAHWeQIEAgSB9gSB8wDxAHYAUaOw9f0BeZxWbbg3eI8MpHrMGyfL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">956IQpoN/tSLBeUAAAGBOJmjFwAABAMARzBFAiEA7Pub0IWm5kMWJrfJGLqP4lZU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">71J6No/RLMwsvXWzVfACICJMzt/AFBsNQ1t970tVRnhmgsgz2s6deykihInBRfZR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AHcARqVV63X6kSAwtaKJafTzfREsQXS+/Um4havy/HD+bUcAAAGBOJmjPwAABAMA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SDBGAiEA92vym4NTX/SmjhAx7ICLE4KXpQFsWfhvRf1m5B6qby8CIQCVyyWh2t22</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">UhaaKSS+nIypJ9jWtOO4wG1gVkty8c/XETANBgkqhkiG9w0BAQsFAAOCAQEAI8fX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MKLNXXoMJk6WTJvV1ORE6kYVtyZm0wM64yV9V1zmksWDgOx9xHmoAUTQYeSq6rhI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tTxgb9EmDF8gVrOXwY31WpWjJyJQAfQcn3LhPUzJnr8yqyiwfVD1FG5gKQTTlblr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">g9sZ+zfETFPXTFJeGT5yBxcT8xQDQNERblVkaQ1H5f2XYuXAJJ4vlNCu7AFil1tp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">U4bau/EfQPx5Jd1bLxJwbeF9FbuQvcMeow+4ElcpC5BSkzsRk7lUbZfj7NWZas5t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3yp0UncNl+Pib3p0ooLDJ3HQvlQuL4AAg2nYkL+UKusZ9d/22RmbiyGkqr+3L/3+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PKvAVy9/DNPwW3YUbQ==</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIFljCCA36gAwIBAgINAgO8U1lrNMcY9QFQZjANBgkqhkiG9w0BAQsFADBHMQsw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZpY2VzIExMQzEU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MBIGA1UEAxMLR1RTIFJvb3QgUjEwHhcNMjAwODEzMDAwMDQyWhcNMjcwOTMwMDAw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MDQyWjBGMQswCQYDVQQGEwJVUzEiMCAGA1UEChMZR29vZ2xlIFRydXN0IFNlcnZp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Y2VzIExMQzETMBEGA1UEAxMKR1RTIENBIDFDMzCCASIwDQYJKoZIhvcNAQEBBQAD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ggEPADCCAQoCggEBAPWI3+dijB43+DdCkH9sh9D7ZYIl/ejLa6T/belaI+KZ9hzp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kgOZE3wJCor6QtZeViSqejOEH9Hpabu5dOxXTGZok3c3VVP+ORBNtzS7XyV3NzsX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lOo85Z3VvMO0Q+sup0fvsEQRY9i0QYXdQTBIkxu/t/bgRQIh4JZCF8/ZK2VWNAcm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BA2o/X3KLu/qSHw3TT8An4Pf73WELnlXXPxXbhqW//yMmqaZviXZf5YsBvcRKgKA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gOtjGDxQSYflispfGStZloEAoPtR28p3CwvJlk/vcEnHXG0g/Zm0tOLKLnf9LdwL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmsTDIwZKxeWmLnwi/agJ7u2441Rj72ux5uxiZ0CAwEAAaOCAYAwggF8MA4GA1Ud</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DwEB/wQEAwIBhjAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwEgYDVR0T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AQH/BAgwBgEB/wIBADAdBgNVHQ4EFgQUinR/r4XN7pXNPZzQ4kYU83E1HScwHwYD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VR0jBBgwFoAU5K8rJnEaK0gnhS9SZizv8IkTcT4waAYIKwYBBQUHAQEEXDBaMCYG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CCsGAQUFBzABhhpodHRwOi8vb2NzcC5wa2kuZ29vZy9ndHNyMTAwBggrBgEFBQcw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AoYkaHR0cDovL3BraS5nb29nL3JlcG8vY2VydHMvZ3RzcjEuZGVyMDQGA1UdHwQt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MCswKaAnoCWGI2h0dHA6Ly9jcmwucGtpLmdvb2cvZ3RzcjEvZ3RzcjEuY3JsMFcG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">A1UdIARQME4wOAYKKwYBBAHWeQIFAzAqMCgGCCsGAQUFBwIBFhxodHRwczovL3Br</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aS5nb29nL3JlcG9zaXRvcnkvMAgGBmeBDAECATAIBgZngQwBAgIwDQYJKoZIhvcN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AQELBQADggIBAIl9rCBcDDy+mqhXlRu0rvqrpXJxtDaV/d9AEQNMwkYUuxQkq/BQ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cSLbrcRuf8/xam/IgxvYzolfh2yHuKkMo5uhYpSTld9brmYZCwKWnvy15xBpPnrL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RklfRuFBsdeYTWU0AIAaP0+fbH9JAIFTQaSSIYKCGvGjRFsqUBITTcFTNvNCCK9U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+o53UxtkOCcXCb1YyRt8OS1b887U7ZfbFAO/CVMkH8IMBHmYJvJh8VNS/UKMG2Yr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PxWhu//2m+OBmgEGcYk1KCTd4b3rGS3hSMs9WYNRtHTGnXzGsYZbr8w0xNPM1IER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">lQCh9BIiAfq0g3GvjLeMcySsN1PCAJA/Ef5c7TaUEDu9Ka7ixzpiO2xj2YC/WXGs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Yye5TBeg2vZzFb8q3o/zpWwygTMD0IZRcZk0upONXbVRWPeyk+gB9lm+cZv9TSjO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">z23HFtz30dZGm6fKa+l3D/2gthsjgx0QGtkJAITgRNOidSOzNIb2ILCkXhAd4FJG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AJ2xDx8hcFH1mt0G/FX0Kw4zd8NLQsLxdxP8c4CU6x+7Nz/OAipmsHMdMqUybDKw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">juDEI/9bfU1lcKwrmz3O2+BtjjKAvpafkmO8l7tdufThcV4q5O8DIrGKZTqPwJNl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1IXNDw9bg1kWRxYtnCQ6yICmJhSFm/Y3m6xv+cXDBlHz4n/FsRC6UfTd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----BEGIN CERTIFICATE-----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIIFYjCCBEqgAwIBAgIQd70NbNs2+RrqIQ/E8FjTDTANBgkqhkiG9w0BAQsFADBX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MQswCQYDVQQGEwJCRTEZMBcGA1UEChMQR2xvYmFsU2lnbiBudi1zYTEQMA4GA1UE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CxMHUm9vdCBDQTEbMBkGA1UEAxMSR2xvYmFsU2lnbiBSb290IENBMB4XDTIwMDYx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OTAwMDA0MloXDTI4MDEyODAwMDA0MlowRzELMAkGA1UEBhMCVVMxIjAgBgNVBAoT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GUdvb2dsZSBUcnVzdCBTZXJ2aWNlcyBMTEMxFDASBgNVBAMTC0dUUyBSb290IFIx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAthECix7joXebO9y/lD63</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ladAPKH9gvl9MgaCcfb2jH/76Nu8ai6Xl6OMS/kr9rH5zoQdsfnFl97vufKj6bwS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iV6nqlKr+CMny6SxnGPb15l+8Ape62im9MZaRw1NEDPjTrETo8gYbEvs/AmQ351k</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KSUjB6G00j0uYODP0gmHu81I8E3CwnqIiru6z1kZ1q+PsAewnjHxgsHA3y6mbWwZ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DrXYfiYaRQM9sHmklCitD38m5agI/pboPGiUU+6DOogrFZYJsuB6jC511pzrp1Zk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">j5ZPaK49l8KEj8C8QMALXL32h7M1bKwYUH+E4EzNktMg6TO8UpmvMrUpsyUqtEj5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cuHKZPfmghCN6J3Cioj6OGaK/GP5Afl4/Xtcd/p2h/rs37EOeZVXtL0m79YB0esW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CruOC7XFxYpVq9Os6pFLKcwZpDIlTirxZUTQAs6qzkm06p98g7BAe+dDq6dso499</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iYH6TKX/1Y7DzkvgtdizjkXPdsDtQCv9Uw+wp9U7DbGKogPeMa3Md+pvez7W35Ei</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Eua++tgy/BBjFFFy3l3WFpO9KWgz7zpm7AeKJt8T11dleCfeXkkUAKIAf5qoIbap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sZWwpbkNFhHax2xIPEDgfg1azVY80ZcFuctL7TlLnMQ/0lUTbiSw1nH69MG6zO0b</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9f6BQdgAmD06yK56mDcYBZUCAwEAAaOCATgwggE0MA4GA1UdDwEB/wQEAwIBhjAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBTkrysmcRorSCeFL1JmLO/wiRNxPjAf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BgNVHSMEGDAWgBRge2YaRQ2XyolQL30EzTSo//z9SzBgBggrBgEFBQcBAQRUMFIw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JQYIKwYBBQUHMAGGGWh0dHA6Ly9vY3NwLnBraS5nb29nL2dzcjEwKQYIKwYBBQUH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAKGHWh0dHA6Ly9wa2kuZ29vZy9nc3IxL2dzcjEuY3J0MDIGA1UdHwQrMCkwJ6Al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oCOGIWh0dHA6Ly9jcmwucGtpLmdvb2cvZ3NyMS9nc3IxLmNybDA7BgNVHSAENDAy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAgGBmeBDAECATAIBgZngQwBAgIwDQYLKwYBBAHWeQIFAwIwDQYLKwYBBAHWeQIF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">AwMwDQYJKoZIhvcNAQELBQADggEBADSkHrEoo9C0dhemMXoh6dFSPsjbdBZBiLg9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NR3t5P+T4Vxfq7vqfM/b5A3Ri1fyJm9bvhdGaJQ3b2t6yMAYN/olUazsaL+yyEn9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WprKASOshIArAoyZl+tJaox118fessmXn1hIVw41oeQa1v1vg4Fv74zPl6/AhSrw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9U5pCZEt4Wi4wStz6dTZ/CLANx8LZh1J7QJVj2fhMtfTJr9w4z30Z209fOU0iOMy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+qduBmpvvYuR7hZL6Dupszfnw0Skfths18dG9ZKb59UhvmaSGZRVbNQpsg3BZlvi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">d0lIKO2d1xozclOzgjXPYovJJIultzkMu34qQb9Sz/yilrbCgj8=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----END CERTIFICATE-----</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There are three certificates.
This is because the server is using a certificate chain.
A <strong>certificate chain</strong> is when the CA signs and intermediate certificate which will then sign the actual certificate.
Or multiple intermediate certificates.
This is used to decentralize the certificate signing process, creating the hierarchical public key infrastructure with self signed root CAs at the top.</p><p>We store the three certificates from Google in the <code>media/</code> folder.
We inspect the subject and issuer of each:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -subject -issuer -in media/google.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subject=CN = www.google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuer=C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -subject -issuer -in media/google_interm2.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subject=C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuer=C = US, O = Google Trust Services LLC, CN = GTS Root R1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -subject -issuer -in media/google_interm1.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subject=C = US, O = Google Trust Services LLC, CN = GTS Root R1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuer=C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The server certificate is for <code>www.google.com</code> and is issued and signed by <code>C = US, O = Google Trust Services LLC, CN = GTS CA 1C3</code>, who in turn is signed by <code>C = US, O = Google Trust Services LLC, CN = GTS Root R1</code>, who in turn is signed by the GlobalSign Root CA.
We extracted the GlobalSign Root CA from Firefox and placed it in the <code>media/</code> folder as well:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -subject -issuer -in media/GlobalSignRootCA.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subject=C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">issuer=C = BE, O = GlobalSign nv-sa, OU = Root CA, CN = GlobalSign Root CA</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To verify the entire security chain we use:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ cat google.crt google_interm2.crt google_interm1.crt &gt; google_chain.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl verify -CAfile google_interm2.crt google_chain.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">google_chain.crt: OK</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The first command creates the <code>google_chain.crt</code> file with the chain of certificates, the most specific certificate first.
The we use <code>openssl verify</code> to successfully verify the certificate chain.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="validation-and-assessment-of-remote-certificates">Validation and Assessment of Remote Certificates<a class="hash-link" href="#validation-and-assessment-of-remote-certificates" title="Direct link to heading">​</a></h3><p>Mostly for testing purposes, we want to know whether a given HTTPS server setup is valid and whether it is secure (i.e. it uses strong TLS parameters).
For this we can use the <a href="https://www.ssllabs.com/ssltest/" target="_blank" rel="noopener noreferrer">SSLTest Web App</a> or the <a href="https://testssl.sh/" target="_blank" rel="noopener noreferrer"><code>testssl.sh</code> CLI tool</a>.</p><p><strong>SSLTest</strong></p><p>Using <a href="https://www.ssllabs.com/ssltest/" target="_blank" rel="noopener noreferrer">SSLTest</a> is quite easy.
Enter the URL of the target web server and then wait for the results.
Results come in a grade summary, that&#x27;s an average of several criteria, and a detailed analysis of the HTTPS security features.</p><p>Generally, it is advised to aim for a higher score.
Note that a higher score may mean using certain security features that some browsers don&#x27;t support.
So there needs to be a trade-off between security and browser support.</p><p><strong>testssl.sh</strong></p><p>Installing <code>testssl.sh</code> is as simple as cloning <a href="https://github.com/drwetter/testssl.sh" target="_blank" rel="noopener noreferrer">the repository</a> and changing to a stable branch:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ git clone https://github.com/drwetter/testssl.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ cd testssl.sh/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git checkout -b v3.0.7 v3.0.7</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now just pass an URL to the <code>testssl.sh</code> script:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./testssl.sh security.cs.pub.ro</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If that doesn&#x27;t work, you can use Docker as detailed in <a href="https://github.com/drwetter/testssl.sh" target="_blank" rel="noopener noreferrer">the repository</a>.</p><p>The output is similar to the one from SSLTest.
The benefit of using <code>testssl.sh</code> is it allows automation and it doesn&#x27;t require a GUI browser to do the test.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="summary-of-commands">Summary of Commands<a class="hash-link" href="#summary-of-commands" title="Direct link to heading">​</a></h2><p>See below a summary of commands useful for working with HTTPS and digital certificates.</p><p>Capture HTTP packets and print their contents (ash human-readable ASCII characters):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ sudo tcpdump -A tcp port 80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Get remote web page:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ wget http://www.google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ wget https://www.google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl http://www.google.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl https://www.google.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Inspect certificate file:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -text -in certificate.crt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl x509 -noout -subject -issuer -in certificate.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Verify certificate:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl verify -CAfile CA.crt certificate.crt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Extract certificate(s) from remote end:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ openssl s_client -showcerts -connect www.google.com:443 -servername www.google.com &lt; /dev/null 2&gt; /dev/null | sed -ne &#x27;/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Assess remote HTTPS and certificate security:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ./testssl.sh security.cs.pub.ro</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="challenges">Challenges<a class="hash-link" href="#challenges" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="01-investigate-ssltls-enabled-websites">01. Investigate SSL/TLS-enabled Websites<a class="hash-link" href="#01-investigate-ssltls-enabled-websites" title="Direct link to heading">​</a></h3><p>Investigate the SSL/TLS configuration strength for different websites.
Use:</p><ul><li><a href="https://www.ssllabs.com/ssltest/" target="_blank" rel="noopener noreferrer">SSL Server Test from SSL Labs</a> in a web browser</li><li><a href="https://testssl.sh/" target="_blank" rel="noopener noreferrer">testssl.sh</a> in the command line</li></ul><p>Investigate the following websites:</p><ul><li><a href="https://curs.upb.ro/" target="_blank" rel="noopener noreferrer">https://curs.upb.ro/</a></li><li><a href="https://ing.ro/" target="_blank" rel="noopener noreferrer">https://ing.ro/</a></li><li><a href="https://senat.ro/" target="_blank" rel="noopener noreferrer">https://senat.ro/</a></li><li><a href="https://republica.ro/" target="_blank" rel="noopener noreferrer">https://republica.ro/</a></li><li><a href="https://www.emag.ro/" target="_blank" rel="noopener noreferrer">https://www.emag.ro/</a></li></ul><p>Look for the following:</p><ul><li>the overall grade</li><li>reasons for not getting the maximum grade</li><li>certificate expiration date</li><li>certification authority (CA)</li><li>SSL/TLS version supported</li></ul><p>Fill the information above in a Google spreadsheet, a copy of <a href="https://docs.google.com/spreadsheets/d/1ufpcQcwSL3LEziqg5tjBK-e7B2xVq0N5xiRcq9yeRHY/edit?usp=sharing" target="_blank" rel="noopener noreferrer">this one</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="02-investigate-remote-ssltls-certificates">02. Investigate Remote SSL/TLS Certificates<a class="hash-link" href="#02-investigate-remote-ssltls-certificates" title="Direct link to heading">​</a></h3><p>Download, inspect and verify remote certificates.
Use <code>openssl s_client</code> to download a certificate.
Use <code>openssl x509</code> to investigate the downloaded certificate.
Use the Certificate Manager-like interface in you browser to extract the corresponding root certificates.
Use <code>openssl verify</code> to verify a certificate;
use the extracted root certificate.</p><p>Investigate the following websites:</p><ul><li><a href="https://slack.com/" target="_blank" rel="noopener noreferrer">https://slack.com/</a></li><li><a href="https://www.pornhub.com/" target="_blank" rel="noopener noreferrer">https://www.pornhub.com/</a></li><li><a href="https://www.emag.ro/" target="_blank" rel="noopener noreferrer">https://www.emag.ro/</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="03-investigate-remote-ssltls-certificates-with-sni">03. Investigate Remote SSL/TLS Certificates with SNI<a class="hash-link" href="#03-investigate-remote-ssltls-certificates-with-sni" title="Direct link to heading">​</a></h3><p>Download, inspect and verify remote certificates.</p><p>Investigate the following websites:</p><ul><li><a href="https://koala.cs.pub.ro" target="_blank" rel="noopener noreferrer">https://koala.cs.pub.ro</a></li><li><a href="https://security.cs.pub.ro" target="_blank" rel="noopener noreferrer">https://security.cs.pub.ro</a></li><li><a href="https://wiki.cs.pub.ro" target="_blank" rel="noopener noreferrer">https://wiki.cs.pub.ro</a></li></ul><p>These websites are colocated on the same IP address:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ host security.cs.pub.ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">security.cs.pub.ro has address 141.85.227.114</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">security.cs.pub.ro mail is handled by 5 security.cs.pub.ro.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ host koala.cs.pub.ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">koala.cs.pub.ro has address 141.85.227.114</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ host wiki.cs.pub.ro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wiki.cs.pub.ro is an alias for koala.cs.pub.ro.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">koala.cs.pub.ro has address 141.85.227.114</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So be sure to use <a href="https://major.io/2012/02/07/using-openssls-s_client-command-with-web-servers-using-server-name-indication-sni/" target="_blank" rel="noopener noreferrer">SNI support</a> (<em>Server Name Indication</em>) for the <code>openssl s_client</code> command to download the correct certificate.
This means using the <code>-servername</code> option.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="04-inspect-me-pem">04. Inspect Me PEM<a class="hash-link" href="#04-inspect-me-pem" title="Direct link to heading">​</a></h3><p>Get the flag from the certificate: <a href="https://sss-web.cyberedu.ro/challenge/25d5c870-fc5a-11ec-bf6f-33097481169b" target="_blank" rel="noopener noreferrer">https://sss-web.cyberedu.ro/challenge/25d5c870-fc5a-11ec-bf6f-33097481169b</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="05-inspect-me-der">05. Inspect Me DER<a class="hash-link" href="#05-inspect-me-der" title="Direct link to heading">​</a></h3><p>Get the flag from the certificate: <a href="https://sss-web.cyberedu.ro/challenge/82120dc0-fc5a-11ec-8907-a767cfc56b45" target="_blank" rel="noopener noreferrer">https://sss-web.cyberedu.ro/challenge/82120dc0-fc5a-11ec-8907-a767cfc56b45</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="06-the-chosen-one">06. The Chosen One<a class="hash-link" href="#06-the-chosen-one" title="Direct link to heading">​</a></h3><p>Find the correct certificate and get the flag from it: <a href="https://sss-web.cyberedu.ro/challenge/38b30e80-fc68-11ec-9c1f-6177b11a278c" target="_blank" rel="noopener noreferrer">https://sss-web.cyberedu.ro/challenge/38b30e80-fc68-11ec-9c1f-6177b11a278c</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="07-proper-naming">07. Proper Naming<a class="hash-link" href="#07-proper-naming" title="Direct link to heading">​</a></h3><p>Get the flag from <a href="http://141.85.224.117:3280" target="_blank" rel="noopener noreferrer">http://141.85.224.117:3280</a>
Submit the flag to: <a href="https://sss-web.cyberedu.ro/challenge/32215080-fc7b-11ec-940b-ad7b1c8e700c" target="_blank" rel="noopener noreferrer">https://sss-web.cyberedu.ro/challenge/32215080-fc7b-11ec-940b-ad7b1c8e700c</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="08-inside">08. Inside<a class="hash-link" href="#08-inside" title="Direct link to heading">​</a></h3><p>Get the flag from <a href="http://141.85.224.117:3380" target="_blank" rel="noopener noreferrer">http://141.85.224.117:3380</a>
Submit the flag to: <a href="https://sss-web.cyberedu.ro/challenge/298a4d30-fc85-11ec-9624-c3b4658b387a" target="_blank" rel="noopener noreferrer">https://sss-web.cyberedu.ro/challenge/298a4d30-fc85-11ec-9624-c3b4658b387a</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="09-only-for-members">09. Only for Members<a class="hash-link" href="#09-only-for-members" title="Direct link to heading">​</a></h3><p>Connect via HTTPS to a <a href="https://141.85.224.117:31443" target="_blank" rel="noopener noreferrer">https://141.85.224.117:31443</a>.
Use client certificate authentication to retrieve the flag.</p><p>The client certificate needs to be signed by the same certification authority as that of the server.
See the files and scripts in the <code>securing-communication/media/ca/</code> folder in the repository.</p><p>Submit flag to: <a href="https://sss-web.cyberedu.ro/challenge/c8d977d0-fc9c-11ec-80d9-0de38261593f" target="_blank" rel="noopener noreferrer">https://sss-web.cyberedu.ro/challenge/c8d977d0-fc9c-11ec-80d9-0de38261593f</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="extra-tutorial-inspect-https-traffic">Extra: Tutorial: Inspect HTTPS Traffic<a class="hash-link" href="#extra-tutorial-inspect-https-traffic" title="Direct link to heading">​</a></h3><p>In this tutorial challenge, we capture and aim to decrypt HTTPS traffic.
We use Wireshark to capture traffic.</p><p>To decrypt traffic, we need to have access to the private key of the server.
Copy the contents of the private key from the Nginx server set up above, from the <code>/etc/letsencrypt/live/&lt;hostname&gt;/privkey.pem</code> into a local file.</p><p>Start Wireshark (as <code>root</code>).
Load the private key in Wireshark using instructions <a href="https://accedian.com/blog/how-to-decrypt-an-https-exchange-with-wireshark/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Start packet capture in Wireshark and filter packets to / from the IP address of the server.
Use a string such as <code>ip.addr = &lt;server_IP_address&gt;</code> in the filter line in Wireshark.</p><p>Use <code>curl</code> to request the index page from the server:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl https://&lt;hostname&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Packet capture in Wireshark will not show decrypted content, similar to the image below.</p><p><img loading="lazy" alt="HTTPS not decrypted" src="/web-security/assets/images/wireshark-no-decrypt-0e193b8134a090ccdfa9ec7bf3ae2023.png" width="866" height="657" class="img_ev3q"></p><p>This is because, by default, the connection uses SSL / TLS ciphers with <a href="https://en.wikipedia.org/wiki/Forward_secrecy" target="_blank" rel="noopener noreferrer">PFS</a> (<em>Perfect Forward Secrecy</em>) usually enabled with DHE (<em>Diffie-Hellman Exchange</em>).
Don&#x27;t bother with the acronyms and their significance, we use them to let you know the terms and maybe look for additional information later on.</p><p>However, we can request <code>curl</code> to not use PFS, by choosing a simpler cipher.
This simple cipher will use the private key that we are in possession of (and that we loaded into Wireshark) to encrypt traffic.
This is also explained <a href="https://accedian.com/blog/how-to-decrypt-an-https-exchange-with-wireshark/" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Use <code>curl</code> to request the index page from the server with a simpler cipher that does not use DHE:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl --ciphers AES256-SHA https://&lt;hostname&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now, the packet capture shows actual decrypted HTTP content, similar to the image below.</p><p><img loading="lazy" alt="HTTPS decrypted" src="/web-security/assets/images/wireshark-decrypt-c473b20402507361d2e02bd67889ab66.png" width="969" height="639" class="img_ev3q"></p><p>You can use <code>Right click</code> -&gt; <code>Follow</code> -&gt; <code>HTTP stream</code> to extract the HTTP traffic only.</p><p>In summary, with access to the private key, if the cipher used in the HTTPS connection (HTTP + SSL / TLS) doesn&#x27;t use DHE, we can decrypt the traffic.
Of course, this requires access to the private key.
In an actual attack this is another part of the attack vector where some server-side vulnerability allows the extraction of the private key.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources-and-tools">Resources and Tools<a class="hash-link" href="#resources-and-tools" title="Direct link to heading">​</a></h2><ul><li><a href="https://www.tcpdump.org/" target="_blank" rel="noopener noreferrer">tcpdump</a></li><li><a href="https://www.wireshark.org/" target="_blank" rel="noopener noreferrer">Wireshark</a></li><li><a href="https://www.openssl.org/" target="_blank" rel="noopener noreferrer">openssl</a></li><li><a href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs" target="_blank" rel="noopener noreferrer">OpenSSL Essentials</a></li><li><a href="https://www.sslshopper.com/article-most-common-openssl-commands.html" target="_blank" rel="noopener noreferrer">The Most Common OpenSSL Commands</a></li><li><a href="https://geekflare.com/openssl-commands-certificates/" target="_blank" rel="noopener noreferrer">OpenSSL Examples</a></li><li><a href="https://jamielinux.com/docs/openssl-certificate-authority/index.html" target="_blank" rel="noopener noreferrer">OpenSSL Certificate Authority</a></li><li><a href="https://testssl.sh/" target="_blank" rel="noopener noreferrer">testssl.sh</a></li><li><a href="https://www.ssllabs.com/ssltest/" target="_blank" rel="noopener noreferrer">SSL Server Test from SSL Labs</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further-reading">Further Reading<a class="hash-link" href="#further-reading" title="Direct link to heading">​</a></h2><ul><li><a href="https://geekflare.com/ssl-test-certificate/" target="_blank" rel="noopener noreferrer">https://geekflare.com/ssl-test-certificate/</a></li><li><a href="https://www.feistyduck.com/library/openssl-cookbook/" target="_blank" rel="noopener noreferrer">https://www.feistyduck.com/library/openssl-cookbook/</a></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/web-security/Network and communication security/Securing communication/Reading/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Reading</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web-security/Network and communication security/Securing communication/securing-communication"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">securing-communication</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#reminders-and-prerequisites" class="table-of-contents__link toc-highlight">Reminders and Prerequisites</a></li><li><a href="#confidentiality" class="table-of-contents__link toc-highlight">Confidentiality</a></li><li><a href="#public-key-cryptography-certificates" class="table-of-contents__link toc-highlight">Public Key Cryptography. Certificates</a><ul><li><a href="#identity-management-certificates" class="table-of-contents__link toc-highlight">Identity Management. Certificates</a></li><li><a href="#inspecting-certificates" class="table-of-contents__link toc-highlight">Inspecting Certificates</a></li><li><a href="#verifying-certificates" class="table-of-contents__link toc-highlight">Verifying Certificates</a></li></ul></li><li><a href="#https-ssl-and-tls" class="table-of-contents__link toc-highlight">HTTPS, SSL and TLS</a><ul><li><a href="#capturing-inspecting-and-verifying-https-certificates" class="table-of-contents__link toc-highlight">Capturing, Inspecting and Verifying HTTPS Certificates</a></li><li><a href="#validation-and-assessment-of-remote-certificates" class="table-of-contents__link toc-highlight">Validation and Assessment of Remote Certificates</a></li></ul></li><li><a href="#summary-of-commands" class="table-of-contents__link toc-highlight">Summary of Commands</a></li><li><a href="#challenges" class="table-of-contents__link toc-highlight">Challenges</a><ul><li><a href="#01-investigate-ssltls-enabled-websites" class="table-of-contents__link toc-highlight">01. Investigate SSL/TLS-enabled Websites</a></li><li><a href="#02-investigate-remote-ssltls-certificates" class="table-of-contents__link toc-highlight">02. Investigate Remote SSL/TLS Certificates</a></li><li><a href="#03-investigate-remote-ssltls-certificates-with-sni" class="table-of-contents__link toc-highlight">03. Investigate Remote SSL/TLS Certificates with SNI</a></li><li><a href="#04-inspect-me-pem" class="table-of-contents__link toc-highlight">04. Inspect Me PEM</a></li><li><a href="#05-inspect-me-der" class="table-of-contents__link toc-highlight">05. Inspect Me DER</a></li><li><a href="#06-the-chosen-one" class="table-of-contents__link toc-highlight">06. The Chosen One</a></li><li><a href="#07-proper-naming" class="table-of-contents__link toc-highlight">07. Proper Naming</a></li><li><a href="#08-inside" class="table-of-contents__link toc-highlight">08. Inside</a></li><li><a href="#09-only-for-members" class="table-of-contents__link toc-highlight">09. Only for Members</a></li><li><a href="#extra-tutorial-inspect-https-traffic" class="table-of-contents__link toc-highlight">Extra: Tutorial: Inspect HTTPS Traffic</a></li></ul></li><li><a href="#resources-and-tools" class="table-of-contents__link toc-highlight">Resources and Tools</a></li><li><a href="#further-reading" class="table-of-contents__link toc-highlight">Further Reading</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://security.cs.pub.ro/summer-school/wiki/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OCW<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/SSSUPB/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 SSS Team</div></div></div></footer></div>
<script src="/web-security/assets/js/runtime~main.98165a6d.js"></script>
<script src="/web-security/assets/js/main.165b39f3.js"></script>
</body>
</html>